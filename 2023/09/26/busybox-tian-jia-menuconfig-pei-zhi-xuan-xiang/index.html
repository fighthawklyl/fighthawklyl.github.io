<!DOCTYPE html>
<html>
  <!-- meta/link... -->
  



<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <!-- Global site tag (gtag.js) - Google Analytics -->


  <title>busyboxç¼–è¯‘ä»¥åŠæ·»åŠ menuconfigé…ç½®é€‰é¡¹ | marysufer&#39;s blog</title>

  
    
<link rel="stylesheet" href="/js/aos/aos.css">

  

  <link rel="icon" type="image/x-icon, image/vnd.microsoft.icon" href="/favicon.ico">
  <link rel="stylesheet" href="https://at.alicdn.com/t/font_1911880_c1nvbyezg17.css">
  <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

  
    <script>
        var themeModelId = '';
        if (themeModelId) {
            localStorage.setItem('modelId', themeModelId);
        }
    </script>
    
    <script src="https://cdn.jsdelivr.net/gh/yuang01/live2d-widget@latest/autoload.js"></script>
    <script>
        var live2dOpen = eval('true') || false;
        if (!live2dOpen) {
            localStorage.setItem('waifu-display', 1609323474481);
        }
    </script>
  
  
<link rel="stylesheet" href="/css/animate.min.css">

  
<link rel="stylesheet" href="/css/style.css">

  
  
    
<link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="/js/shareJs/share.min.css">

  
  <style>
        @media (max-width: 992px) {
            #waifu {
                display: none;
            }
        }
    </style>
    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<meta name="generator" content="Hexo 5.4.0"></head>

  
  <!-- ä¾èµ–äºjqueryå’Œvue -->
  <script src="/js/jquery3.5.1.js"></script>
  <script src="/js/vue2.6.11.js"></script>
  
  <body>
    <!-- é¢„åŠ è½½åŠ¨ç”» -->
    <!-- é¡µé¢é¢„åŠ è½½åŠ¨ç”» -->

<div id='loader'>
  <link rel="stylesheet" href="/js/loaded/index.css" >
  <div class="loading-left-bg"></div>
  <div class="loading-right-bg"></div>
  <div class="spinner-box">
    <div class="configure-border-1">
      <div class="configure-core"></div>
    </div>
    <div class="configure-border-2">
      <div class="configure-core"></div>
    </div>
    <div class="loading-word">åŠ è½½ä¸­...</div>
  </div>
</div>

<script>
  var endLoading = function () {
  document.body.style.overflow = 'auto';
  document.getElementById('loader').classList.add("loading");
  }
  window.addEventListener('load',endLoading);
</script>

    
    <!-- åˆ¤æ–­æ˜¯å¦ä¸ºæš—é»‘é£æ ¼ -->
    <!-- åˆ¤æ–­æ˜¯å¦ä¸ºé»‘å¤œæ¨¡å¼ -->
<script>
  let isDark = JSON.parse(localStorage.getItem('dark')) || JSON.parse('false');

  if (isDark) {
    $(document.body).addClass('darkModel');
  }
</script>

    <!-- å¤´éƒ¨å¯¼èˆªç­‰ -->
    
<header class="header " id="navHeader"
  style="position: fixed;
  left: 0; top: 0; z-index: 10;width: 100%;"
>
  <div class="header-content">
    <div class="bars">
      <div id="appDrawer" class="sidebar-image">
  <i class="fa fa-bars" aria-hidden="true" @click="showDialogDrawer"></i>
  <transition name="fade">
    <div class="drawer-box_mask" v-cloak style="display: none;" v-show="visible" @click.self="cancelDialogDrawer">
    </div>
  </transition>
  <div class="drawer-box" :class="{'active': visible}">
    <div class="drawer-box-head bg-color">
      <img class="drawer-box-head_logo" src="/medias/logo.png" alt="logo">
      <h3 class="drawer-box-head_title">marysufer&#39;s blog</h3>
      <h5 class="drawer-box-head_desc"></h5>
    </div>
    
    <div class="drawer-box-content">
      <ul class="drawer-box-content_menu">
        
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/" class="drawer-menu-item-link">
                  
                    <i class="fa fa-home" aria-hidden="true"></i>
                  
                  <span class="name">é¦–é¡µ</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/archives" class="drawer-menu-item-link">
                  
                    <i class="fa fa-archive" aria-hidden="true"></i>
                  
                  <span class="name">å½’æ¡£</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/tags" class="drawer-menu-item-link">
                  
                    <i class="fa fa-tags" aria-hidden="true"></i>
                  
                  <span class="name">æ ‡ç­¾</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/categories" class="drawer-menu-item-link">
                  
                    <i class="fa fa-bookmark" aria-hidden="true"></i>
                  
                  <span class="name">åˆ†ç±»</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/about" class="drawer-menu-item-link">
                  
                    <i class="fa fa-user" aria-hidden="true"></i>
                  
                  <span class="name">å…³äº</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/friends" class="drawer-menu-item-link">
                  
                    <i class="fa fa-plug" aria-hidden="true"></i>
                  
                  <span class="name">å‹æƒ…é“¾æ¥</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="javascript:;" class="drawer-menu-item-link has-children" @click="openOrCloseMenu(6)">
                  <span>
                    
                    <span class="name">ğŸ‘‡æ›´å¤š</span>
                  </span>
                  <i class="fa fa-chevron-left arrow " :class="{'icon-rotate': isOpen(6)}" aria-hidden="true"></i>
                </a>
                <ul class="drawer-sub-menu" v-if="isOpen(6)">
                  
                  <li>
                    <a href="/gallery">
                      
                      <span>ğŸ’»å›¾åº“</span>
                    </a>
                  </li>
                  
                  <li>
                    <a href="/huoban">
                      
                      <span>ğŸ¤å‹æƒ…è¿æ¥</span>
                    </a>
                  </li>
                  
                  <li>
                    <a href="/me">
                      
                      <span>ğŸ¤¡å…³äºæˆ‘</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="http://baidu.com">
                      
                      <span>ğŸ”ç™¾åº¦</span>
                    </a>
                  </li>
                  
                </ul>
              
            </li>
          
        
        <li class="drawer-box-content_item">
          <a target="_blank" rel="noopener" href="https://github.com/fighthawklyl">
            <i class="fa fa-github" aria-hidden="true"></i>
            <span>Github</span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appDrawer',
    data: {
      visible: false,
      top: 0,
      openArr: [],
    },
    computed: {
    },
    mounted() {
    },
    methods: {
      isOpen(index) {
        if (this.openArr.includes(index)) {
          return true;
        } else {
          return false;
        }
      },
      openOrCloseMenu(curIndex) {
        const index = this.openArr.indexOf(curIndex);
        if (index !== -1) {
          this.openArr.splice(index, 1);
        } else {
          this.openArr.push(curIndex);
        }
      },
      showDialogDrawer() {
        this.visible = true;
        // é˜²æ­¢é¡µé¢æ»šåŠ¨ï¼Œåªèƒ½è®©å¼¹æ¡†æ»šåŠ¨
        this.top = $(document).scrollTop()
        body.style.cssText = 'width: 100%; height: 100%;overflow: hidden;';
      },
      cancelDialogDrawer() {
        this.visible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      }
    },
    created() {}
  })
</script>

    </div>
    <div class="blog-title" id="author-avatar">
      
        <div class="avatar">
          <img src="/medias/logo.png" alt="logo">
        </div>
      
      <a href="/" class="logo">marysufer&#39;s blog</a>
    </div>
    <nav class="navbar">
      <ul class="menu">
        
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/" class="menu-item-link">
                  
                    <i class="fa fa-home" aria-hidden="true"></i>
                  
                  <span class="name">é¦–é¡µ</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/archives" class="menu-item-link">
                  
                    <i class="fa fa-archive" aria-hidden="true"></i>
                  
                  <span class="name">å½’æ¡£</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/tags" class="menu-item-link">
                  
                    <i class="fa fa-tags" aria-hidden="true"></i>
                  
                  <span class="name">æ ‡ç­¾</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/categories" class="menu-item-link">
                  
                    <i class="fa fa-bookmark" aria-hidden="true"></i>
                  
                  <span class="name">åˆ†ç±»</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/about" class="menu-item-link">
                  
                    <i class="fa fa-user" aria-hidden="true"></i>
                  
                  <span class="name">å…³äº</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/friends" class="menu-item-link">
                  
                    <i class="fa fa-plug" aria-hidden="true"></i>
                  
                  <span class="name">å‹æƒ…é“¾æ¥</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="javascript:;" class="menu-item-link">
                  
                  <span class="name">ğŸ‘‡æ›´å¤š</span>
                  <i class="fa fa-chevron-down arrow" aria-hidden="true"></i>
                </a>
                <ul class="sub-menu">
                  
                  <li>
                    <a href="/gallery">
                      
                      <span>ğŸ’»å›¾åº“</span>
                    </a>
                  </li>
                  
                  <li>
                    <a href="/huoban">
                      
                      <span>ğŸ¤å‹æƒ…è¿æ¥</span>
                    </a>
                  </li>
                  
                  <li>
                    <a href="/me">
                      
                      <span>ğŸ¤¡å…³äºæˆ‘</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="http://baidu.com">
                      
                      <span>ğŸ”ç™¾åº¦</span>
                    </a>
                  </li>
                  
                </ul>
              
            </li>
          
        
      </ul>
      
      
        <div id="appSearch">
  <div class="search"  @click="showDialog()"><i class="fa fa-search" aria-hidden="true"></i></div>
  <transition name="fade">
    <div class="message-box_wrapper" style="display: none;" v-cloak v-show="dialogVisible" @click.self="cancelDialogVisible()">
      <div class="message-box animated bounceInDown">
        <!-- <div class="close" style="overflow: hidden;">
          <i class="fa fa-close" aria-hidden="true" style="float:right;" @click.self="cancelDialogVisible()"></i>
        </div> -->
        <h2>
          <span>
            <i class="fa fa-search" aria-hidden="true"></i>
            <span class="title">æœ¬åœ°æœç´¢</span>
          </span>
          <i class="fa fa-close close" style="float:right;" aria-hidden="true" @click.self="cancelDialogVisible()"></i>
        </h2>
        <form class="site-search-form">
          <input type="text"
            placeholder="è¯·è¾“å…¥å…³é”®å­—"
            id="local-search-input" 
            @click="getSearchFile()"
            class="st-search-input"
            v-model="searchInput"
          />
        </form>
        <div class="result-wrapper">
          <div id="local-search-result" class="local-search-result-cls"></div>
        </div>
      </div>
    </div>
  </transition>
</div>
<script src="/js/local_search.js"></script>
<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appSearch',
    data: {
      dialogVisible: false,
      searchInput: '',
      top: 0,
    },
    computed: {
    },
    mounted() {
    },
    methods: {
      showDialog() {
        this.dialogVisible = true;
        // é˜²æ­¢é¡µé¢æ»šåŠ¨ï¼Œåªèƒ½è®©å¼¹æ¡†æ»šåŠ¨
        this.top = $(document).scrollTop()
        body.style.cssText = 'overflow: hidden;';
      },
      getSearchFile() {
        if (!this.searchInput) {
          getSearchFile("/search.xml");
        }
      },
      cancelDialogVisible() {
        this.dialogVisible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      },
    },
    created() {}
  })
</script>
<!-- è§£å†³åˆ·æ–°é¡µé¢é—ªçƒé—®é¢˜ï¼Œå¯ä»¥åœ¨å…ƒç´ ä¸Šæ·»åŠ display: none, æˆ–è€…ç”¨vue.extendæ–¹æ³•ï¼Œè¯¦æƒ…ï¼šhttps://blog.csdn.net/qq_31393401/article/details/81017912 -->
<!-- ä¸‹é¢æ˜¯æœç´¢åŸºæœ¬å†™æ³• -->
<!-- <script type="text/javascript" id="local.search.active">
  var inputArea = document.querySelector("#local-search-input");
  inputArea.onclick   = function(){ getSearchFile(); this.onclick = null }
  inputArea.onkeydown = function(){ if(event.keyCode == 13) return false }
</script> -->

      

    </nav>
  </div>
  
  <a target="_blank" rel="noopener" href="https://github.com/fighthawklyl" class="github-corner color-primary" aria-label="View source on GitHub"><svg width="60" height="60" viewBox="0 0 250 250" style="fill:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  
    <div id="he-plugin-simple"></div>
    <script>
      WIDGET = {
        CONFIG: {
          "modules": "012",
          "background": 5,
          "tmpColor": "4A4A4A",
          "tmpSize": 16,
          "cityColor": "4A4A4A",
          "citySize": 16,
          "aqiSize": 16,
          "weatherIconSize": 24,
          "alertIconSize": 18,
          "padding": "10px 10px 10px 10px",
          "shadow": "1",
          "language": "auto",
          "borderRadius": 5,
          "fixed": "false",
          "vertical": "middle",
          "horizontal": "center",
          "key": "2784dd3fcb1e4f0f9a9b579bf69641f2"
        }
      }
    </script>
    <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script> 
    

    <!-- å½“å¤´éƒ¨å¯¼èˆªè®¾ç½®ä¸ºèƒŒæ™¯é€æ˜çš„æ—¶å€™  -->
    
      <script src="/js/header/index.js"></script>
    
</header>

    <!-- å†…å®¹åŒºåŸŸ -->
    <main class="main" style="margin-top: 0;">
      
 <!-- prismjs ä»£ç é«˜äº® -->
 
    
    <link href="/js/prism/prism-line-numbers.css" rel="stylesheet">
    
        <link href="/js/prism/prism-tomorrow.min.css" rel="stylesheet">
    

    <style>
        pre[class*="language-"] {
            overflow-y: hidden;
        }
        .line-numbers .line-numbers-rows {
            border: none;
        }
    </style>
  


<div class="bg-dark-floor" style="position: fixed;left: 0;top: 0;width: 100%;height: 100%;z-index: -1;"></div>

<!-- æ–‡ç« è¯¦æƒ…é¡µé¡¶éƒ¨å›¾ç‰‡å’Œæ ‡é¢˜ -->




<div class="post-detail-header lazyload" id="thumbnail_canvas" data-original="/medias/13.jpg" style="background-repeat: no-repeat; background-size: cover; 
  background-position: center center;position: relative;">
  <div class="post-detail-header-mask"></div>
  <canvas id="header_canvas"style="position:absolute;bottom:0;pointer-events:none;"></canvas>
  
  <div class="title-box">
    <span class="title">
      busyboxç¼–è¯‘ä»¥åŠæ·»åŠ menuconfigé…ç½®é€‰é¡¹
    </span>
  </div>
  
  
    <script src="/js/bubble/bubble.js"></script>
  
</div>



<div class="row justify-position">
  <div class="main-content">
    <article class="post post-detail">
      
      <div class="post-meta">
        <i class="fa fa-clock-o" aria-hidden="true"></i>
        <span class="post-time">2023-09-26</span>
      </div>
      
      <div class="post-tags-categories">
        
        <div class="tags">
          <i class="iconfont icontag"></i>
          
            <a href="/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F/" class="">
              åµŒå…¥å¼
            </a>
          
            <a href="/tags/busybox/" class="">
              busybox
            </a>
          
            <a href="/tags/romfs/" class="">
              romfs
            </a>
          
            <a href="/tags/rootfs/" class="">
              rootfs
            </a>
          
            <a href="/tags/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" class="">
              æ–‡ä»¶ç³»ç»Ÿ
            </a>
          
            <a href="/tags/telnetd/" class="">
              telnetd
            </a>
          
            <a href="/tags/udhcpd/" class="">
              udhcpd
            </a>
          
        </div>
        
        
        <div class="categories">
          <i class="iconfont iconbookmark1"></i>
          
            <a href="/categories/busybox/" class="">
              busybox
            </a>
          
        </div>
        
      </div>
      <div class="post-content">
        <h4 id="ä¸€ã€busyboxä»‹ç»"><a href="#ä¸€ã€busyboxä»‹ç»" class="headerlink" title="ä¸€ã€busyboxä»‹ç»"></a>ä¸€ã€busyboxä»‹ç»</h4><p>Busyboxæ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œéµå¾ªGPL v2åè®®ã€‚Busyboxå°†ä¼—å¤šçš„UNIXå‘½ä»¤é›†åˆè¿›äº†ä¸€ä¸ªå¾ˆå°çš„å¯æ‰§è¡Œç¨‹åºä¸­ï¼Œå¯ä»¥ç”¨æ¥æ›¿ä»£GNU fileutilsã€shellutilsç­‰å·¥å…·é›†ã€‚Busyboxä¸­å„ç§å‘½ä»¤ä¸ç›¸åº”çš„GNUå·¥å…·ç›¸æ¯”ï¼Œæ‰€èƒ½æä¾›çš„é€‰é¡¹æ¯”è¾ƒå°‘ï¼Œä½†æ˜¯å¯¹äºä¸€èˆ¬çš„åº”ç”¨åœºæ™¯ä¹Ÿè¶³å¤Ÿäº†ã€‚Busyboxä¸»è¦ç”¨äºåµŒå…¥å¼ç³»ç»Ÿçš„å¼€å‘ä¸­ã€‚</p>
<h4 id="äºŒã€busyboxç›®å½•ç»“æ„"><a href="#äºŒã€busyboxç›®å½•ç»“æ„" class="headerlink" title="äºŒã€busyboxç›®å½•ç»“æ„"></a>äºŒã€busyboxç›®å½•ç»“æ„</h4><table>
    <tr>
        <td>åºå·</td> 
        <td>ç›®å½•åç§°</td>
        <td>åŠŸèƒ½è¯´æ˜</td>
   </tr>
    <tr>
        <td > 1 </td>    
        <td >applets</td> 
        <td >å®ç°appletsæ¡†æ¶çš„æ–‡ä»¶ã€‚ç›®å½•ä¸­åŒ…å«äº†å‡ ä¸ªmain()çš„æ–‡ä»¶</td>  
    </tr>
    <tr>
        <td >2</td>
        <td >applets_sh</td>    
        <td >æ­¤ç›®å½•åŒ…å«äº†å‡ ä¸ªä½œä¸ºshellè„šæœ¬å®ç°çš„appletç¤ºä¾‹ã€‚åœ¨â€œmake installâ€æ—¶ä¸ä¼šè¢«è‡ªåŠ¨å®‰è£…ï¼Œéœ€è¦ä½¿ç”¨æ—¶ï¼Œæ‰‹åŠ¨å¤„ç†</td>  
    </tr>
    <tr>
        <td >3</td>
        <td >arch</td>   
        <td >åŒ…å«ç”¨äºä¸åŒä½“ç³»æ¶æ„çš„makefileæ–‡ä»¶ã€‚çº¦æŸbusyboxåœ¨ä¸åŒæ¶æ„ä½“ç³»ä¸‹çš„ç¼–è¯‘æ„å»ºè¿‡ç¨‹</td>   
    </tr>
    <tr>
        <td >4</td>
        <td >archival</td>   
        <td >ä¸å‹ç¼©ç›¸å…³å‘½ä»¤çš„å®ç°æºæ–‡ä»¶</td>   
    </tr>
    <tr>
        <td >5</td>
        <td >configs</td>   
        <td >busyboxè‡ªå¸¦çš„é»˜è®¤é…ç½®æ–‡ä»¶</td>   
    </tr>
    <tr>
        <td >6</td>
        <td >console-tools</td>   
        <td >ä¸æ§åˆ¶å°ç›¸å…³çš„ä¸€äº›å‘½ä»¤</td>   
    </tr>
    <tr>
        <td >7</td>
        <td >coreutils</td>   
        <td >å¸¸ç”¨çš„ä¸€äº›æ ¸å¿ƒå‘½ä»¤ã€‚ä¾‹å¦‚chgrpã€rmç­‰</td>   
    </tr>
    <tr>
        <td >8</td>
        <td >debianutils</td>   
        <td >é’ˆå¯¹Debiançš„å¥—ä»¶ã€‚</td>   
    </tr>
    <tr>
        <td >9</td>
        <td >e2fsprogs</td>   
        <td >é’ˆå¯¹Linux Ext2 FS progçš„å‘½ä»¤ã€‚ä¾‹å¦‚chattrã€lsattr</td>   
    </tr>
    <tr>
        <td >10</td>
        <td >editors</td>   
        <td >å¸¸ç”¨çš„ç¼–è¾‘å‘½ä»¤ã€‚ä¾‹å¦‚diffã€viç­‰</td>   
    </tr>
    <tr>
        <td >11</td>
        <td >findutils</td>   
        <td >ç”¨äºæŸ¥æ‰¾çš„å‘½ä»¤</td>   
    </tr>
    <tr>
        <td >12</td>
        <td >include</td>   
        <td >busyboxé¡¹ç›®çš„å¤´æ–‡ä»¶</td>   
    </tr>
    <tr>
        <td >13</td>
        <td >init</td>   
        <td >initè¿›ç¨‹çš„å®ç°æºç ç›®å½•</td>   
    </tr>
    <tr>
        <td >14</td>
        <td >klibc-utils</td>   
        <td >klibcå‘½ä»¤å¥—ä»¶</td>   
    </tr>
    <tr>
        <td >15</td>
        <td >libbb</td>   
        <td >ä¸busyboxå®ç°ç›¸å…³çš„åº“æ–‡ä»¶</td>   
    </tr>
    <tr>
        <td >16</td>
        <td >libpwdgrp</td>   
        <td >libpwdgrpç›¸å…³çš„å‘½ä»¤</td>   
    </tr>
    <tr>
        <td >17</td>
        <td >loginutils</td>   
        <td >ä¸ç”¨æˆ·ç®¡ç†ç›¸å…³çš„å‘½ä»¤</td>   
    </tr>
    <tr>
        <td >18</td>
        <td >mailutils</td>   
        <td >ä¸mailç›¸å…³çš„å‘½ä»¤å¥—ä»¶</td>   
    </tr>
    <tr>
        <td >19</td>
        <td >miscutils</td>   
        <td >è¯¥æ–‡ä»¶ä¸‹æ˜¯ä¸€äº›æ‚é¡¹å‘½ä»¤ï¼Œé’ˆå¯¹ç‰¹å®šåº”ç”¨åœºæ™¯</td>   
    </tr>
    <tr>
        <td >20</td>
        <td >modutils</td>   
        <td >ä¸æ¨¡å—ç›¸å…³çš„å‘½ä»¤</td>   
    </tr>
    <tr>
        <td >21</td>
        <td >networking</td>   
        <td >ä¸ç½‘ç»œç›¸å…³çš„å‘½ä»¤ï¼Œä¾‹å¦‚arp</td>   
    </tr>
    <tr>
        <td >22</td>
        <td >printutils</td>   
        <td >Printç›¸å…³çš„å‘½ä»¤</td>   
    </tr>
    <tr>
        <td >23</td>
        <td >procps</td>   
        <td >ä¸å†…å­˜ã€è¿›ç¨‹ç›¸å…³çš„å‘½ä»¤</td>   
    </tr>
    <tr>
        <td >24</td>
        <td >runit</td>   
        <td >ä¸Runitå®ç°ç›¸å…³çš„å‘½ä»¤</td>   
    </tr>
    <tr>
        <td >25</td>
        <td >shell</td>   
        <td >ä¸shellç›¸å…³çš„å‘½ä»¤</td>   
    </tr>
    <tr>
        <td >26</td>
        <td >sysklogd</td>   
        <td >ç³»ç»Ÿæ—¥å¿—è®°å½•å·¥å…·ç›¸å…³çš„å‘½ä»¤</td>   
    </tr>
    <tr>
        <td >27</td>
        <td >util-linux</td>   
        <td >Linuxä¸‹å¸¸ç”¨çš„å‘½ä»¤ï¼Œä¸»è¦ä¸æ–‡ä»¶ç³»ç»Ÿæ“ä½œç›¸å…³çš„å‘½ä»¤</td>   
    </tr>
</table>

<h4 id="ä¸‰ã€ç¼–è¯‘busybox-ï¼ˆBusyBox-1-33-1ï¼‰"><a href="#ä¸‰ã€ç¼–è¯‘busybox-ï¼ˆBusyBox-1-33-1ï¼‰" class="headerlink" title="ä¸‰ã€ç¼–è¯‘busybox ï¼ˆBusyBox-1.33.1ï¼‰"></a>ä¸‰ã€ç¼–è¯‘busybox ï¼ˆBusyBox-1.33.1ï¼‰</h4><h5 id="1ã€make-menuconfig"><a href="#1ã€make-menuconfig" class="headerlink" title="1ã€make menuconfig"></a>1ã€make menuconfig</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">make</span> menuconfig<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img "" class="lazyload placeholder" data-original="/photo/busybox/make_menuconfig.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="make menuconfigç•Œé¢"></p>
<p>é…ç½®installè·¯å¾„ï¼Œé¦–å…ˆé€‰æ‹©Settingsâ€”&gt;<br><img "" class="lazyload placeholder" data-original="/photo/busybox/menuconfig_Settings.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="Settings---&gt;"><br>ç„¶åé€‰æ‹©Installation Optionsä¸­çš„Destination path for â€˜make installâ€™é€‰é¡¹é…ç½®installç›®å½•ã€‚<br><img "" class="lazyload placeholder" data-original="/photo/busybox/menuconfig_Install_opt.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="Installation Options"><br>æˆ‘ä»¬å°†å…¶è®¾ç½®ä¸ºromfs<br><img "" class="lazyload placeholder" data-original="/photo/busybox/menuconfig_Install_opt_setting.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="set ./romfs"><br>ä¿å­˜configåå¯ä»¥å†ç›®å½•ä¸­çœ‹åˆ°ä¸€ä¸ª.configæ–‡ä»¶</p>
<h5 id="3ã€ç¼–è¯‘å’Œå»ºç«‹romfsç›®å½•"><a href="#3ã€ç¼–è¯‘å’Œå»ºç«‹romfsç›®å½•" class="headerlink" title="3ã€ç¼–è¯‘å’Œå»ºç«‹romfsç›®å½•"></a>3ã€ç¼–è¯‘å’Œå»ºç«‹romfsç›®å½•</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#å»ºç«‹romfsç›®å½•</span>
<span class="token function">mkdir</span> romfs
<span class="token builtin class-name">cd</span> rootfs
<span class="token comment">#å»ºç«‹ä¸€äº›å¸¸ç”¨ç›®å½•</span>
<span class="token function">mkdir</span> root home bin sbin etc dev usr lib tmp mnt sys proc  
<span class="token function">mkdir</span> usr/lib usr/bin

<span class="token comment">#é…ç½®äº¤å‰ç¼–è¯‘å™¨ï¼Œä¿®æ”¹Makefileæ–‡ä»¶</span>
ARCH ?<span class="token operator">=</span> arm
CROSS_COMPILE ?<span class="token operator">=</span> <span class="token comment">#æŒ‡å®šäº¤å‰ç¼–è¯‘å™¨è·¯å¾„</span>

<span class="token comment">#ç¼–è¯‘</span>
<span class="token comment">#make åå°±ä¼šäº§ç”Ÿbusybox</span>
<span class="token function">make</span>
<span class="token comment">#make installåå°±äº§ç”ŸbusyboxåŠæ¯ä¸ªå‘½ä»¤çš„è½¯é“¾æ¥ã€‚</span>
<span class="token function">make</span> <span class="token function">install</span>

<span class="token builtin class-name">cd</span> etc
<span class="token comment">#æ‹·è´examples/bootfloppy/etcæ–‡ä»¶åˆ°etc</span>
<span class="token function">cp</span> -rf <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/examples/bootfloppy/etc/* ./
<span class="token comment">#passwdã€shadowã€groupç­‰æ–‡ä»¶ä¹Ÿéœ€è¦å‡†å¤‡æ”¾åˆ°etcä¸‹</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ‹·è´examples/inittab åˆ° etcä¸‹,åšä¸€äº›å¿…è¦çš„ä¿®æ”¹</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># /etc/inittab init(8) configuration for BusyBox</span>
<span class="token comment">#</span>
<span class="token comment"># Copyright (C) 1999-2004 by Erik Andersen &lt;andersen@codepoet.org></span>
<span class="token comment">#</span>
<span class="token comment">#</span>
<span class="token comment"># Note, BusyBox init doesn't support runlevels.  The runlevels field is</span>
<span class="token comment"># completely ignored by BusyBox init. If you want runlevels, use sysvinit.</span>
<span class="token comment">#</span>
<span class="token comment">#</span>
<span class="token comment"># Format for each entry: &lt;id>:&lt;runlevels>:&lt;action>:&lt;process></span>
<span class="token comment">#</span>
<span class="token comment"># &lt;id>: WARNING: This field has a non-traditional meaning for BusyBox init!</span>
<span class="token comment">#</span>
<span class="token comment">#	The id field is used by BusyBox init to specify the controlling tty for</span>
<span class="token comment">#	the specified process to run on.  The contents of this field are</span>
<span class="token comment">#	appended to "/dev/" and used as-is.  There is no need for this field to</span>
<span class="token comment">#	be unique, although if it isn't you may have strange results.  If this</span>
<span class="token comment">#	field is left blank, then the init's stdin/out will be used.</span>
<span class="token comment">#</span>
<span class="token comment"># &lt;runlevels>: The runlevels field is completely ignored.</span>
<span class="token comment">#</span>
<span class="token comment"># &lt;action>: Valid actions include: sysinit, wait, once, respawn, askfirst,</span>
<span class="token comment">#                                  shutdown, restart and ctrlaltdel.</span>
<span class="token comment">#</span>
<span class="token comment">#	sysinit actions are started first, and init waits for them to complete.</span>
<span class="token comment">#	wait actions are started next, and init waits for them to complete.</span>
<span class="token comment">#	once actions are started next (and not waited for).</span>
<span class="token comment">#</span>
<span class="token comment">#	askfirst and respawn are started next.</span>
<span class="token comment">#	For askfirst, before running the specified process, init displays</span>
<span class="token comment">#	the line "Please press Enter to activate this console"</span>
<span class="token comment">#	and then waits for the user to press enter before starting it.</span>
<span class="token comment">#</span>
<span class="token comment">#	shutdown actions are run on halt/reboot/poweroff, or on SIGQUIT.</span>
<span class="token comment">#	Then the machine is halted/rebooted/powered off, or for SIGQUIT,</span>
<span class="token comment">#	restart action is exec'ed (init process is replaced by that process).</span>
<span class="token comment">#	If no restart action specified, SIGQUIT has no effect.</span>
<span class="token comment">#</span>
<span class="token comment">#	ctrlaltdel actions are run when SIGINT is received</span>
<span class="token comment">#	(this might be initiated by Ctrl-Alt-Del key combination).</span>
<span class="token comment">#	After they complete, normal processing of askfirst / respawn resumes.</span>
<span class="token comment">#</span>
<span class="token comment">#	Note: unrecognized actions (like initdefault) will cause init to emit</span>
<span class="token comment">#	an error message, and then go along with its business.</span>
<span class="token comment">#</span>
<span class="token comment"># &lt;process>: Specifies the process to be executed and it's command line.</span>
<span class="token comment">#</span>
<span class="token comment"># Note: BusyBox init works just fine without an inittab. If no inittab is</span>
<span class="token comment"># found, it has the following default behavior:</span>
<span class="token comment">#	::sysinit:/etc/init.d/rcS</span>
<span class="token comment">#	::askfirst:/bin/sh</span>
<span class="token comment">#	::ctrlaltdel:/sbin/reboot</span>
<span class="token comment">#	::shutdown:/sbin/swapoff -a</span>
<span class="token comment">#	::shutdown:/bin/umount -a -r</span>
<span class="token comment">#	::restart:/sbin/init</span>
<span class="token comment">#	tty2::askfirst:/bin/sh</span>
<span class="token comment">#	tty3::askfirst:/bin/sh</span>
<span class="token comment">#	tty4::askfirst:/bin/sh</span>
<span class="token comment">#</span>
<span class="token comment"># Boot-time system configuration/initialization script.</span>
<span class="token comment"># This is run first except when booting in single-user mode.</span>
<span class="token comment">#</span>
::sysinit:/etc/init.d/rcS

<span class="token comment"># /bin/sh invocations on selected ttys</span>
<span class="token comment">#</span>
<span class="token comment"># Note below that we prefix the shell commands with a "-" to indicate to the</span>
<span class="token comment"># shell that it is supposed to be a login shell.  Normally this is handled by</span>
<span class="token comment"># login, but since we are bypassing login in this case, BusyBox lets you do</span>
<span class="token comment"># this yourself...</span>
<span class="token comment">#</span>
<span class="token comment"># Start an "askfirst" shell on the console (whatever that may be)</span>
<span class="token comment">#askfirstç±»ä¼¼respawnï¼Œä¸»è¦ç”¨é€”æ˜¯å‡å°‘ç³»ç»Ÿä¸Šæ‰§è¡Œçš„ç»ˆç«¯åº”ç”¨ç¨‹åºçš„æ•°é‡ã€‚å®ƒå°†ä¼šä¿ƒä½¿initåœ¨æ§åˆ¶å°ä¸Šæ˜¾ç¤ºâ€œPlease press Enter to active this consoleâ€çš„ä¿¡æ¯ï¼Œå¹¶åœ¨é‡æ–°å¯åŠ¨è¿›ç¨‹ä¹‹å‰ç­‰å¾…ç”¨æˆ·æŒ‰ä¸‹â€œenterâ€é”®</span>
<span class="token comment">#::askfirst:-/bin/sh</span>
<span class="token comment"># Start an "askfirst" shell on /dev/tty2-4</span>
<span class="token comment">#</span>
<span class="token comment">#tty2::askfirst:-/bin/sh</span>
<span class="token comment">#tty3::askfirst:-/bin/sh</span>
<span class="token comment">#tty4::askfirst:-/bin/sh</span>

<span class="token comment"># /sbin/getty invocations for selected ttys</span>
<span class="token comment">#å±è”½</span>
<span class="token comment">#tty4::respawn:/sbin/getty 38400 tty5</span>
<span class="token comment">#tty5::respawn:/sbin/getty 38400 tty6</span>

<span class="token comment"># Example of how to put a getty on a serial line (for a terminal)</span>
::respawn:/sbin/getty -L ttyS000 <span class="token number">115200</span> vt100 -n root -I <span class="token string">"Auto login as root ..."</span>
<span class="token comment">#::respawn:/sbin/getty -L ttyS0 9600 vt100</span>
<span class="token comment">#::respawn:/sbin/getty -L ttyS1 9600 vt100</span>
<span class="token comment">#</span>
<span class="token comment"># Example how to put a getty on a modem line.</span>
<span class="token comment">#::respawn:/sbin/getty 57600 ttyS2</span>

<span class="token comment"># Stuff to do when restarting the init process</span>
::restart:/sbin/init

<span class="token comment"># Stuff to do before rebooting</span>
::ctrlaltdel:/sbin/reboot
::shutdown:/bin/umount -a -r
::shutdown:/sbin/swapoff -a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ‹·è´äº¤å‰ç¼–è¯‘ç¯å¢ƒä¸‹çš„libåº“åˆ°romfs/libç›®å½•ä¸‹</p>
<h4 id="å››ã€busyboxçš„menuconfigæ·»åŠ è‡ªå®šä¹‰ç¼–è¯‘é€‰é¡¹"><a href="#å››ã€busyboxçš„menuconfigæ·»åŠ è‡ªå®šä¹‰ç¼–è¯‘é€‰é¡¹" class="headerlink" title="å››ã€busyboxçš„menuconfigæ·»åŠ è‡ªå®šä¹‰ç¼–è¯‘é€‰é¡¹"></a>å››ã€busyboxçš„menuconfigæ·»åŠ è‡ªå®šä¹‰ç¼–è¯‘é€‰é¡¹</h4><p>ä»¥telnetdç«¯å£å’Œudhcpd macé™åˆ¶å’Œhostnameé™åˆ¶ä¸ºä¾‹</p>
<h5 id="1ã€Config-src-å’Œ-Config-in"><a href="#1ã€Config-src-å’Œ-Config-in" class="headerlink" title="1ã€Config.src å’Œ Config.in"></a>1ã€Config.src å’Œ Config.in</h5><p>Config.srcæ–‡ä»¶ä¸­ä¿å­˜ç€make menuconfigé…ç½®ç•Œé¢ä¸Šçš„é…ç½®<br>Config.inæ˜¯é€šè¿‡Config.srcå’Œ.cæºç ä¸­çš„ä¸€äº›configé…ç½®ç»“åˆäº§ç”Ÿçš„ã€‚<br>ä¸‹é¢ä»¥networking/Config.srcä¸ºä¾‹å¤§è‡´è¯´æ˜é…ç½®çš„å«ä¹‰</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#</span>
<span class="token comment"># For a description of the syntax of this configuration file,</span>
<span class="token comment"># see docs/Kconfig-language.txt.</span>
<span class="token comment">#</span>

<span class="token comment">#èœå•é€‰é¡¹</span>
menu <span class="token string">"Networking Utilities"</span> 

config FEATURE_IPV6
	bool <span class="token string">"Enable IPv6 support"</span>
	default y
	<span class="token builtin class-name">help</span>
	Enable IPv6 support <span class="token keyword">in</span> busybox.
	This adds IPv6 support <span class="token keyword">in</span> the networking applets.

config FEATURE_UNIX_LOCAL
	bool <span class="token string">"Enable Unix domain socket support (usually not needed)"</span>
	default n
	<span class="token builtin class-name">help</span>
	Enable Unix domain socket support <span class="token keyword">in</span> all busybox networking
	applets.  Address of the form local:/path/to/unix/socket
	will be recognized.

	This extension is almost never used <span class="token keyword">in</span> real world usage.
	You <span class="token function">most</span> likely want to say N.

config FEATURE_PREFER_IPV4_ADDRESS
	bool <span class="token string">"Prefer IPv4 addresses from DNS queries"</span>
	default y
	depends on FEATURE_IPV6
	<span class="token builtin class-name">help</span>
	Use IPv4 address of network <span class="token function">host</span> <span class="token keyword">if</span> it has one.

	If this option is off, the first returned address will be used.
	This may cause problems when your DNS server is IPv6-capable and
	is returning IPv6 <span class="token function">host</span> addresses too. If IPv6 address
	precedes IPv4 one <span class="token keyword">in</span> DNS reply, busybox network applets
	<span class="token punctuation">(</span>e.g. <span class="token function">wget</span><span class="token punctuation">)</span> will use IPv6 address. On an IPv6-incapable <span class="token function">host</span>
	or network applets will fail to connect to the <span class="token function">host</span>
	using IPv6 address.

config VERBOSE_RESOLUTION_ERRORS
	bool <span class="token string">"Verbose resolution errors"</span>
	default n
	<span class="token builtin class-name">help</span>
	Enable <span class="token keyword">if</span> you are not satisfied with simplistic
	<span class="token string">"can't resolve 'hostname.com'"</span> and want to know more.
	This may increase size of your executable a bit.

config FEATURE_TLS_SHA1 <span class="token comment">#configé…ç½®å</span>
	bool <span class="token string">"In TLS code, support ciphers which use deprecated SHA1"</span> <span class="token comment">#æ•°æ®ç±»å‹æ˜¯boolå‹æ‰€ä»¥å‚æ•°æ˜¯ yå’Œn</span>
	depends on TLS  <span class="token comment">#ä¾èµ–TLSå¼€å¯è¯¥é…ç½®æ‰å¯ä»¥ç”Ÿæ•ˆé…ç½®ã€‚</span>
	default n       <span class="token comment">#é»˜è®¤é…ç½®ä¸ºn,ä¸å¼€å¯</span>
	<span class="token builtin class-name">help</span>   <span class="token comment">#helpä»‹ç»è¯¥é…ç½®</span>
	Selecting this option increases interoperability with very old
	servers, but slightly increases code size.

	Most TLS servers support SHA256 today <span class="token punctuation">(</span><span class="token number">2018</span><span class="token punctuation">)</span>, since SHA1 is
	considered possibly insecure <span class="token punctuation">(</span>although not yet definitely broken<span class="token punctuation">)</span>.
<span class="token comment">#INSERT</span>
<span class="token comment">#source networking/udhcp/Config.in</span>
<span class="token comment">#æ˜¯å°†é‡Œé¢ä¸€çº§çš„ç›®å½•ä¸­çš„é…ç½®æ’å…¥è¿›æœ¬æ–‡ä»¶ï¼Œæ‰€æœ‰é…ç½®éƒ½æ˜¯å¦‚æ­¤ä¸€å±‚ä¸€å±‚ç›®å½•ä¸­æ’å…¥è¿‡æ¥ã€‚ä¹Ÿèƒ½å°†cæºæ–‡ä»¶ä¸­æ³¨é‡Šè¯­å¥ä¸­çš„configæ’å…¥</span>
INSERT

<span class="token builtin class-name">source</span> networking/udhcp/Config.in

config IFUPDOWN_UDHCPC_CMD_OPTIONS
	string <span class="token string">"ifup udhcpc command line options"</span>
	default <span class="token string">"-R -n"</span>
	depends on IFUP <span class="token operator">||</span> IFDOWN
	<span class="token builtin class-name">help</span>
	Command line options to pass to udhcpc from ifup.
	Intended to alter options not available <span class="token keyword">in</span> /etc/network/interfaces.
	<span class="token punctuation">(</span>IE: --syslog --background etc<span class="token punctuation">..</span>.<span class="token punctuation">)</span>

endmenu<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="2ã€Kbuild-srcå’ŒKbuild"><a href="#2ã€Kbuild-srcå’ŒKbuild" class="headerlink" title="2ã€Kbuild.srcå’ŒKbuild"></a>2ã€Kbuild.srcå’ŒKbuild</h5><p>Kbuild.srcæ˜¯æ›´å…·é…ç½®å†³å®šæŸä¸ªæºæ–‡ä»¶æ˜¯å¦è¦ç¼–è¯‘çš„é…ç½®æ–‡ä»¶ï¼Œæ¯”å¦‚æ·»åŠ æ–°çš„æºæ–‡ä»¶è¦é€šè¿‡é…ç½®æ¥æ§åˆ¶å°±éœ€è¦å†è¿™è¾¹æ·»åŠ <br>Kbuildæ˜¯ç”±Kbuild.srcå’Œé€’å½’å½“å‰æºæ–‡ä»¶ä¸‹çš„é…ç½®è€Œæˆ<br>ä»¥networking/udhcp/Kbuild.srcä¸ºä¾‹</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># Makefile for busybox</span>
<span class="token comment">#</span>
<span class="token comment"># Copyright (C) 1999-2004 by Erik Andersen &lt;andersen@codepoet.org></span>
<span class="token comment">#</span>
<span class="token comment"># Licensed under GPLv2 or later, see file LICENSE in this source tree.</span>
<span class="token comment">#</span>

lib-y:<span class="token operator">=</span>

<span class="token comment">#INSERT å¯ä»¥æ’å…¥.Cæºæ–‡ä»¶ä¸­æ³¨é‡Šä¸­çš„Kbuildé…ç½®ç”ŸæˆKbuildï¼Œä¸€å±‚ä¸€å±‚çš„ç”Ÿæˆåï¼Œé€’å½’åå°±å¾—åˆ°æ‰€æœ‰è¦ç¼–è¯‘è¿›å»çš„æ–‡ä»¶</span>
INSERT
<span class="token comment">#$(CONFIG_UDHCPC)å°±æ˜¯å†makeconfigæ‰€é…ç½®çš„ï¼Œä¸ºyæˆ–è€…n</span>
lib-<span class="token variable"><span class="token variable">$(</span>CONFIG_UDHCPC<span class="token variable">)</span></span>     <span class="token operator">+=</span> common.o packet.o signalpipe.o socket.o
lib-<span class="token variable"><span class="token variable">$(</span>CONFIG_UDHCPD<span class="token variable">)</span></span>     <span class="token operator">+=</span> common.o packet.o signalpipe.o socket.o

lib-<span class="token variable"><span class="token variable">$(</span>CONFIG_UDHCPC<span class="token variable">)</span></span>     <span class="token operator">+=</span> dhcpc.o
lib-<span class="token variable"><span class="token variable">$(</span>CONFIG_UDHCPD<span class="token variable">)</span></span>     <span class="token operator">+=</span> dhcpd.o arpping.o
lib-<span class="token variable"><span class="token variable">$(</span>CONFIG_DUMPLEASES<span class="token variable">)</span></span> <span class="token operator">+=</span> dumpleases.o
lib-<span class="token variable"><span class="token variable">$(</span>CONFIG_DHCPRELAY<span class="token variable">)</span></span>  <span class="token operator">+=</span> dhcprelay.o common.o socket.o packet.o

lib-<span class="token variable"><span class="token variable">$(</span>CONFIG_FEATURE_UDHCPC_ARPING<span class="token variable">)</span></span> <span class="token operator">+=</span> arpping.o
lib-<span class="token variable"><span class="token variable">$(</span>CONFIG_FEATURE_UDHCP_RFC3397<span class="token variable">)</span></span> <span class="token operator">+=</span> domain_codec.o<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="3ã€æ·»åŠ telnetd-ç«¯å£è‡ªå®šä¹‰é…ç½®"><a href="#3ã€æ·»åŠ telnetd-ç«¯å£è‡ªå®šä¹‰é…ç½®" class="headerlink" title="3ã€æ·»åŠ telnetd ç«¯å£è‡ªå®šä¹‰é…ç½®"></a>3ã€æ·»åŠ telnetd ç«¯å£è‡ªå®šä¹‰é…ç½®</h5><p>æ‰“å¼€telnetdç›¸å…³æºæ–‡ä»¶ï¼Œå†å…¶æºæ–‡ä»¶ä¸­æ·»åŠ é…ç½®ä¿®æ”¹ä»£ç </p>
<p>telnetd.c</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//config:config IS_NOLANCHECK</span>
<span class="token comment">//config:	bool "Support not check lan"</span>
<span class="token comment">//config:	default n</span>
<span class="token comment">//config:	depends on TELNETD</span>
<span class="token comment">//config:	help</span>
<span class="token comment">//config:	Support check lan.</span>
<span class="token comment">//config:</span>
<span class="token comment">//config:config TELNETD_PORT</span>
<span class="token comment">//config:	int "Support set telnetd port"</span>
<span class="token comment">//config:	default 25565</span>
<span class="token comment">//config:	range 0 65535</span>
<span class="token comment">//config:	depends on TELNETD</span>
<span class="token comment">//config:	help</span>
<span class="token comment">//config:	set telnetd port.</span>
<span class="token comment">//config:</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img "" class="lazyload placeholder" data-original="/photo/busybox/telnetdConfig.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="telnetdConfig"><br><img "" class="lazyload placeholder" data-original="/photo/busybox/telnetdPort.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="telnetdPort"><br>CONFIG_TELNETD_PORTå®å®šä¹‰åœ¨include/autoconf.hå¤´æ–‡ä»¶ä¸­æ˜¯ç”±make menuconfigç”Ÿæˆçš„å¤´æ–‡ä»¶<br>æ·»åŠ IS_NOLANCHECKå’ŒTELNETD_PORTä¸¤ä¸ªé…ç½®ã€‚<br>IS_NOLANCHECKçš„æ•°æ®ç±»å‹æ˜¯boolæ‰€ä»¥æ˜¯yå’Œnï¼ŒTELNETD_PORTæ•°æ®ç±»å‹æ˜¯intæ‰€ä»¥æ˜¯æ•°å­—ã€‚<br>defaultå­—æ®µé…ç½®è¯¥é€‰é¡¹çš„é»˜è®¤é…ç½®ï¼Œç«¯å£é»˜è®¤é…ç½®ä¸º50119åšäº†ä¿®æ”¹å’Œå¸¸è§„çš„ç«¯å£ä¸åŒï¼Œrange 0 65535è¯­å¥é™åˆ¶ç«¯å£è®¾ç½®çš„èŒƒå›´å†0åˆ°65535ä¹‹é—´ã€‚ä¸¤ä¸ªé…ç½®éƒ½æœ‰depends on TELNETDï¼Œä¾èµ–è¯¥å‰ç½®é…ç½®ï¼Œåªæœ‰TELNETDé…ç½®å¼€å¯åæ‰èƒ½ç”Ÿæ•ˆã€‚æºç ä¸­æŠŠå†™æ­»çš„ç«¯å£ä¿®æ”¹ä¸ºCONFIG_TELNETD_PORTã€‚å°±å®ç°äº†å†menuconfigé…ç½®ç«¯å£ã€‚<br>å¦‚ä¸‹å›¾ï¼Œå¯ä»¥çœ‹åˆ°é…ç½®è¡¨ä¸­å·²ç»å¤šäº†ç«¯å£é…ç½®é€‰é¡¹ã€‚<br><img "" class="lazyload placeholder" data-original="/photo/busybox/menuconfig_telnetdPort.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="menuconfig_telnetdPort"></p>
<h5 id="4ã€dhcpdæ·»åŠ è‡ªå®šä¹‰hostnameé™åˆ¶å’Œè‡ªå®šä¹‰macåœ°å€é™åˆ¶"><a href="#4ã€dhcpdæ·»åŠ è‡ªå®šä¹‰hostnameé™åˆ¶å’Œè‡ªå®šä¹‰macåœ°å€é™åˆ¶" class="headerlink" title="4ã€dhcpdæ·»åŠ è‡ªå®šä¹‰hostnameé™åˆ¶å’Œè‡ªå®šä¹‰macåœ°å€é™åˆ¶"></a>4ã€dhcpdæ·»åŠ è‡ªå®šä¹‰hostnameé™åˆ¶å’Œè‡ªå®šä¹‰macåœ°å€é™åˆ¶</h5><p>networking/udhcp/Config.srcæ–‡ä»¶ä¸­æ·»åŠ ç›¸å…³menuconfigé…ç½®é€‰é¡¹å¦‚ä¸‹<br>Config.src</p>
<pre><code class="c">#
# For a description of the syntax of this configuration file,
# see docs/Kconfig-language.txt.
#

config UDHCPD
    bool &quot;udhcpd (21 kb)&quot;
    default y
    help
    udhcpd is a DHCP server geared primarily toward embedded systems,
    while striving to be fully functional and RFC compliant.
#######################æ·»åŠ å¼€å§‹###############################
#æ˜¯å¦å¼€å¯honstnameè®¾ç½®åŠŸèƒ½
config UDHCPD_SET_HOSTNAME
    bool &quot;udhcpd set hostname restrictions&quot;
    default n
    depends on UDHCPD
    help
    udhcpd set hostname restrictions.
#honstnameè®¾ç½®é€‰é¡¹ï¼Œæ•°æ®ç±»å‹ä¸ºstringï¼Œé»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²å³ä¸é™åˆ¶
config UDHCPD_HOSTNAME
    string &quot;udhcpd set hostname restrictions&quot;
    default &quot;&quot;
    depends on UDHCPD_SET_HOSTNAME
    help
    A hostname is &quot;A&quot;
    B hostname is &quot;B&quot;
#æ˜¯å¦å¼€å¯macé™åˆ¶åŠŸèƒ½
config UDHCPD_SET_HOSTMAC
    bool &quot;udhcpd set  mac restrictions&quot;
    default n
    depends on UDHCPD
    help
    udhcpd set  mac restrictions.
#é…ç½®macé™åˆ¶ï¼Œå†å¯¹åº”macå­—æ®µé…ç½®macå³å¯é™åˆ¶è¯¥å­—æ®µã€‚å¯ä»¥å®ç°è‡ªå®šä¹‰ä»»æ„ä½macé™åˆ¶
config UDHCPD_HOSTMAC
    string &quot;udhcpd set hostmac restrictions&quot;
    default &quot;51:1B:17:::&quot;
    depends on UDHCPD_SET_HOSTMAC
    help
    Example  Restrict MAC 51:1B:17:::
    Restrict the first 3 MAC addresses is 0x51 0x1B 0x17,
    can allocate IP.
    Example  Restrict MAC ::::2B:
    Restrict the fifth MAC addresses is 0x2B,can allocate IP.
################################æ·»åŠ ç»“æŸ#############################
<pre class="line-numbers language-none"><code class="language-none">
ä¸‹å›¾æ˜¯udhcpdç›¸å…³menuconfigæ·»åŠ åçš„é€‰é¡¹ï¼Œé€‰ä¸Šudhpcdé€‰é¡¹åå°±ä¼šå‡ºç°udhcpd set hostname restrictionså’Œudhcpd set  mac restrictionsé€‰é¡¹ï¼Œå°†è¿™ä¸¤ä¸ªé€‰é¡¹é€‰ä¸­åå³å¯è‡ªå®šä¹‰hostnameé™åˆ¶å’Œmacé™åˆ¶ã€‚
![menuconfig_udhcpd](&#x2F;photo&#x2F;busybox&#x2F;menuconfig_udhcpd.png)

udhcpd.cæºç æœ‰ä¿®æ”¹çš„å‡½æ•°å¦‚ä¸‹
&#96;&#96;&#96;&#96;C
static NOINLINE void send_offer(struct dhcp_packet *oldpacket,
		uint32_t static_lease_nip,
		struct dyn_lease *lease,
		uint32_t requested_nip,
		unsigned arpping_ms)
&#123;
	struct dhcp_packet packet;
	uint32_t lease_time_sec;

	init_packet(&amp;packet, oldpacket, DHCPOFFER);

	&#x2F;* If it is a static lease, use its IP *&#x2F;
	packet.yiaddr &#x3D; static_lease_nip;
	&#x2F;* Else: *&#x2F;
	if (!static_lease_nip) &#123;
		&#x2F;* We have no static lease for client&#39;s chaddr *&#x2F;
		const char *p_host_name;

		if (lease) &#123;
			&#x2F;* We have a dynamic lease for client&#39;s chaddr.
			 * Reuse its IP (even if lease is expired).
			 * Note that we ignore requested IP in this case.
			 *&#x2F;
			packet.yiaddr &#x3D; lease-&gt;lease_nip;
		&#125;
		&#x2F;* Or: if client has requested an IP *&#x2F;
		else if (requested_nip !&#x3D; 0
		 &#x2F;* and the IP is in the lease range *&#x2F;
		 &amp;&amp; ntohl(requested_nip) &gt;&#x3D; server_data.start_ip
		 &amp;&amp; ntohl(requested_nip) &lt;&#x3D; server_data.end_ip
		 &#x2F;* and *&#x2F;
		 &amp;&amp; (  !(lease &#x3D; find_lease_by_nip(requested_nip)) &#x2F;* is not already taken *&#x2F;
		    || is_expired_lease(lease) &#x2F;* or is taken, but expired *&#x2F;
		    )
		) &#123;
			packet.yiaddr &#x3D; requested_nip;
		&#125;
		else &#123;
			&#x2F;* Otherwise, find a free IP *&#x2F;
			packet.yiaddr &#x3D; find_free_or_expired_nip(oldpacket-&gt;chaddr, arpping_ms);
		&#125;

		if (!packet.yiaddr) &#123;
			bb_simple_error_msg(&quot;no free IP addresses. OFFER abandoned&quot;);
			return;
		&#125;
		&#x2F;* Reserve the IP for a short time hoping to get DHCPREQUEST soon *&#x2F;
		p_host_name &#x3D; (const char*) udhcp_get_option(oldpacket, DHCP_HOST_NAME);

&#x2F;*********hostnameé™åˆ¶ *********&#x2F;
&#x2F;*ENABLE_UDHCPD_SET_HOSTNAMEå®å®šä¹‰åœ¨include&#x2F;autoconf.hå¤´æ–‡ä»¶ä¸­ï¼Œ
è¯¥å¤´æ–‡ä»¶æ˜¯make menuconfigé…ç½®é€‰é¡¹ä¿å­˜åç”Ÿæˆçš„*&#x2F;
#if ENABLE_UDHCPD_SET_HOSTNAME 
		if(p_host_name !&#x3D; NULL &amp;&amp; strstr(p_host_name, CONFIG_UDHCPD_HOSTNAME))
		&#123;
			lease &#x3D; add_lease(packet.chaddr, packet.yiaddr,
					server_data.offer_time,
					p_host_name,
					p_host_name ? (unsigned char)p_host_name[OPT_LEN - OPT_DATA] : 0
			);
		&#125;
		else
		&#123;
			bb_info_msg(&quot;Not Found --&gt; %s\n&quot;,CONFIG_UDHCPD_HOSTNAME);
			return;
		&#125;
#else
		lease &#x3D; add_lease(packet.chaddr, packet.yiaddr,
				server_data.offer_time,
				p_host_name,
				p_host_name ? (unsigned char)p_host_name[OPT_LEN - OPT_DATA] : 0
		);
#endif
&#x2F;********* hostnameé™åˆ¶ *********&#x2F;
		if (!lease) &#123;
			bb_simple_error_msg(&quot;no free IP addresses. OFFER abandoned&quot;);
			return;
		&#125;
	&#125;

	lease_time_sec &#x3D; select_lease_time(oldpacket);
	udhcp_add_simple_option(&amp;packet, DHCP_LEASE_TIME, htonl(lease_time_sec));
	add_server_options(&amp;packet);

	&#x2F;* send_packet emits error message itself if it detects failure *&#x2F;
	send_packet_verbose(&amp;packet, &quot;sending OFFER to %s&quot;);
&#125;

&#x2F;********* MACé™åˆ¶ *********&#x2F;
&#x2F;*è¿™ä¸¤ä¸ªå‡½æ•°ä¸»è¦åŠŸèƒ½æ˜¯è§£æé…ç½®ä¸‹æ¥çš„macé™åˆ¶
CONFIG_UDHCPD_HOSTMACå’ŒENABLE_UDHCPD_SET_HOSTMACå®å®šä¹‰åœ¨include&#x2F;autoconf.hå¤´æ–‡ä»¶ä¸­ï¼Œ
è¯¥å¤´æ–‡ä»¶make menuconfigé…ç½®åç”Ÿæˆçš„å¤´æ–‡ä»¶
*&#x2F;
#if ENABLE_UDHCPD_SET_HOSTMAC
static int strToChar(char *pStr, int j, unsigned char *pMacCh)
&#123;
	int i;
	if(j &gt; 2) return -1;  &#x2F;&#x2F;mac err
	for(i &#x3D; j;i &gt; 0;i-- )
	&#123;
		if( pStr[i - 1] &gt;&#x3D; &#39;a&#39; &amp;&amp; pStr[i - 1] &lt;&#x3D; &#39;f&#39;)
		&#123;
			*pMacCh +&#x3D; (pStr[i - 1] - &#39;a&#39; + 0xa) * (0x1 &lt;&lt; 4*(j-i));
		&#125;
		else if( pStr[i - 1] &gt;&#x3D; &#39;A&#39; &amp;&amp; pStr[i - 1] &lt;&#x3D; &#39;F&#39;)
		&#123;
			*pMacCh +&#x3D; (pStr[i - 1] - &#39;A&#39; + 0xa) * (0x1 &lt;&lt; 4*(j-i));
		&#125;
		else if( pStr[i - 1] &gt;&#x3D; &#39;0&#39; &amp;&amp; pStr[i - 1] &lt;&#x3D; &#39;9&#39;)
		&#123;
			*pMacCh +&#x3D; (pStr[i - 1] - &#39;0&#39;) * (0x1 &lt;&lt; 4*(j-i));
		&#125;
	&#125;
	return 0;
&#125;

static int parseHostMac(unsigned char *pMac, int *pMask)
&#123;
	char arrStr[4] &#x3D; &#123;&#125;;
	char *pPreMac &#x3D; CONFIG_UDHCPD_HOSTMAC;
	int strLen &#x3D; strlen(CONFIG_UDHCPD_HOSTMAC);
	char *pTemp;
	char *pTempMac &#x3D; pPreMac;
	int i,j;
	
	*pMask &#x3D; 0;
	for(i &#x3D; 0; i &lt; 5; i++)
	&#123;
		pTemp &#x3D; strstr(pTempMac, &quot;:&quot;);
		if(NULL &#x3D;&#x3D; pTemp)
		&#123;
			return -1;
		&#125;

		if(pTemp - pTempMac &gt; 2) return -1;

		j &#x3D; 0;
		memset(arrStr,0,4);
		while(pTemp - pTempMac )
		&#123;
			arrStr[j] &#x3D; pTempMac[0];
			pTempMac +&#x3D; 1;
			j++;
		&#125;

		pTempMac +&#x3D; 1;
		if(j)
		&#123;
			if(strToChar(arrStr, j, &amp;pMac[i])) return -1;
			*pMask |&#x3D; 0x1 &lt;&lt; i;
		&#125;
		

		if(i &#x3D;&#x3D; 4)
		&#123;
			j &#x3D; 0;
			memset(arrStr,0,4);
			while(pTempMac - pPreMac &lt; strLen)
			&#123;
				arrStr[j] &#x3D; pTempMac[0];
				pTempMac +&#x3D; 1;
				j++;
			&#125;
			if(j)
			&#123;
				if(strToChar(arrStr, j, &amp;pMac[i+1])) return -1;
				*pMask |&#x3D; 0x1 &lt;&lt; (i + 1);
			&#125;
		&#125;
	&#125;

	return 0;
&#125;
#endif
&#x2F;********* MACé™åˆ¶*********&#x2F;

int udhcpd_main(int argc UNUSED_PARAM, char **argv)
&#123;
	int server_socket &#x3D; -1, retval;
	uint8_t *state;
	unsigned timeout_end;
	unsigned num_ips;
	unsigned opt;
	struct option_set *option;
	char *str_I &#x3D; str_I;
	const char *str_a &#x3D; &quot;2000&quot;;
	unsigned arpping_ms;
	IF_FEATURE_UDHCP_PORT(char *str_P;)

	setup_common_bufsiz();

	IF_FEATURE_UDHCP_PORT(SERVER_PORT &#x3D; 67;)
	IF_FEATURE_UDHCP_PORT(CLIENT_PORT &#x3D; 68;)

	&#x2F;* Make sure fd 0,1,2 are open *&#x2F;
	&#x2F;* Setup the signal pipe on fds 3,4 - must be before openlog() *&#x2F;
	udhcp_sp_setup();

	opt &#x3D; getopt32(argv, &quot;^&quot;
		&quot;fSI:va:&quot;IF_FEATURE_UDHCP_PORT(&quot;P:&quot;)
		&quot;\0&quot;
#if defined CONFIG_UDHCP_DEBUG &amp;&amp; CONFIG_UDHCP_DEBUG &gt;&#x3D; 1
		&quot;vv&quot;
#endif
		, &amp;str_I
		, &amp;str_a
		IF_FEATURE_UDHCP_PORT(, &amp;str_P)
		IF_UDHCP_VERBOSE(, &amp;dhcp_verbose)
		);
	if (!(opt &amp; 1)) &#123; &#x2F;* no -f *&#x2F;
		bb_daemonize_or_rexec(0, argv);
		logmode &#x3D; LOGMODE_NONE;
	&#125;
	&#x2F;* update argv after the possible vfork+exec in daemonize *&#x2F;
	argv +&#x3D; optind;
	if (opt &amp; 2) &#123; &#x2F;* -S *&#x2F;
		openlog(applet_name, LOG_PID, LOG_DAEMON);
		logmode |&#x3D; LOGMODE_SYSLOG;
	&#125;
	if (opt &amp; 4) &#123; &#x2F;* -I *&#x2F;
		len_and_sockaddr *lsa &#x3D; xhost_and_af2sockaddr(str_I, 0, AF_INET);
		server_data.server_nip &#x3D; lsa-&gt;u.sin.sin_addr.s_addr;
		free(lsa);
	&#125;
#if ENABLE_FEATURE_UDHCP_PORT
	if (opt &amp; 32) &#123; &#x2F;* -P *&#x2F;
		SERVER_PORT &#x3D; xatou16(str_P);
		CLIENT_PORT &#x3D; SERVER_PORT + 1;
	&#125;
#endif
	arpping_ms &#x3D; xatou(str_a);

	&#x2F;* Would rather not do read_config before daemonization -
	 * otherwise NOMMU machines will parse config twice *&#x2F;
	read_config(argv[0] ? argv[0] : DHCPD_CONF_FILE);
	&#x2F;* prevent poll timeout overflow *&#x2F;
	if (server_data.auto_time &gt; INT_MAX &#x2F; 1000)
		server_data.auto_time &#x3D; INT_MAX &#x2F; 1000;

	&#x2F;* Create pidfile *&#x2F;
	write_pidfile(server_data.pidfile);
	&#x2F;* if (!..) bb_perror_msg(&quot;can&#39;t create pidfile %s&quot;, pidfile); *&#x2F;

	bb_simple_info_msg(&quot;started, v&quot;BB_VER);

	option &#x3D; udhcp_find_option(server_data.options, DHCP_LEASE_TIME);
	server_data.max_lease_sec &#x3D; DEFAULT_LEASE_TIME;
	if (option) &#123;
		move_from_unaligned32(server_data.max_lease_sec, option-&gt;data + OPT_DATA);
		server_data.max_lease_sec &#x3D; ntohl(server_data.max_lease_sec);
	&#125;

	&#x2F;* Sanity check *&#x2F;
	num_ips &#x3D; server_data.end_ip - server_data.start_ip + 1;
	if (server_data.max_leases &gt; num_ips) &#123;
		bb_error_msg(&quot;max_leases&#x3D;%u is too big, setting to %u&quot;,
			(unsigned)server_data.max_leases, num_ips);
		server_data.max_leases &#x3D; num_ips;
	&#125;

	&#x2F;* this sets g_leases *&#x2F;
	SET_PTR_TO_GLOBALS(xzalloc(server_data.max_leases * sizeof(g_leases[0])));

	read_leases(server_data.lease_file);

	if (udhcp_read_interface(server_data.interface,
			&amp;server_data.ifindex,
			(server_data.server_nip &#x3D;&#x3D; 0 ? &amp;server_data.server_nip : NULL),
			server_data.server_mac)
	) &#123;
		retval &#x3D; 1;
		goto ret;
	&#125;
&#x2F;*********  MACé™åˆ¶ *********&#x2F;
&#x2F;*è§£æmacé™åˆ¶
ENABLE_UDHCPD_SET_HOSTMACå®å®šä¹‰åœ¨include&#x2F;autoconf.hå¤´æ–‡ä»¶ä¸­ï¼Œ
è¯¥å¤´æ–‡ä»¶make menuconfigé…ç½®åç”Ÿæˆçš„å¤´æ–‡ä»¶
*&#x2F;
#if ENABLE_UDHCPD_SET_HOSTMAC
	int mask &#x3D;0;
	unsigned char mac[6] &#x3D; &#123;&#125;;
	int err &#x3D; parseHostMac(mac, &amp;mask);
	bb_info_msg(&quot;mask_mac %02x %02x %02x %02x %02x %02x  mask &#x3D; %x \n&quot;,mac[0],mac[1],mac[2],mac[3],mac[4],mac[5],mask);
	if(err) 
	&#123;
		bb_info_msg(&quot;SET_HOSTMAC is error!\n&quot;);
		goto ret;
	&#125;
#endif
&#x2F;********* MACé™åˆ¶ *********&#x2F;
 continue_with_autotime:
	timeout_end &#x3D; monotonic_sec() + server_data.auto_time;
	while (1) &#123; &#x2F;* loop until universe collapses *&#x2F;
		struct pollfd pfds[2];
		struct dhcp_packet packet;
		int bytes;
		int tv;
		uint8_t *server_id_opt;
		uint8_t *requested_ip_opt;
		uint32_t requested_nip;
		uint32_t static_lease_nip;
		struct dyn_lease *lease, fake_lease;

		if (server_socket &lt; 0) &#123;
			server_socket &#x3D; udhcp_listen_socket(&#x2F;*INADDR_ANY,*&#x2F; SERVER_PORT,
					server_data.interface);
		&#125;

		udhcp_sp_fd_set(pfds, server_socket);

 new_tv:
		tv &#x3D; -1;
		if (server_data.auto_time) &#123;
			tv &#x3D; timeout_end - monotonic_sec();
			if (tv &lt;&#x3D; 0) &#123;
 write_leases:
				write_leases();
				goto continue_with_autotime;
			&#125;
			tv *&#x3D; 1000;
		&#125;

		&#x2F;* Block here waiting for either signal or packet *&#x2F;
		retval &#x3D; poll(pfds, 2, tv);
		if (retval &lt;&#x3D; 0) &#123;
			if (retval &#x3D;&#x3D; 0)
				goto write_leases;
			if (errno &#x3D;&#x3D; EINTR)
				goto new_tv;
			&#x2F;* &lt; 0 and not EINTR: should not happen *&#x2F;
			bb_simple_perror_msg_and_die(&quot;poll&quot;);
		&#125;

		if (pfds[0].revents) switch (udhcp_sp_read()) &#123;
		case SIGUSR1:
			bb_info_msg(&quot;received %s&quot;, &quot;SIGUSR1&quot;);
			write_leases();
			&#x2F;* why not just reset the timeout, eh *&#x2F;
			goto continue_with_autotime;
		case SIGTERM:
			bb_info_msg(&quot;received %s&quot;, &quot;SIGTERM&quot;);
			write_leases();
			goto ret0;
		&#125;

		&#x2F;* Is it a packet? *&#x2F;
		if (!pfds[1].revents)
			continue; &#x2F;* no *&#x2F;

		&#x2F;* Note: we do not block here, we block on poll() instead.
		 * Blocking here would prevent SIGTERM from working:
		 * socket read inside this call is restarted on caught signals.
		 *&#x2F;
		bytes &#x3D; udhcp_recv_kernel_packet(&amp;packet, server_socket);
		if (bytes &lt; 0) &#123;
			&#x2F;* bytes can also be -2 (&quot;bad packet data&quot;) *&#x2F;
			if (bytes &#x3D;&#x3D; -1 &amp;&amp; errno !&#x3D; EINTR) &#123;
				log1(&quot;read error: &quot;STRERROR_FMT&quot;, reopening socket&quot; STRERROR_ERRNO);
				close(server_socket);
				server_socket &#x3D; -1;
			&#125;
			continue;
		&#125;
		if (packet.hlen !&#x3D; 6) &#123;
			bb_info_msg(&quot;MAC length !&#x3D; 6%s&quot;, &quot;, ignoring packet&quot;);
			continue;
		&#125;
		if (packet.op !&#x3D; BOOTREQUEST) &#123;
			bb_info_msg(&quot;not a REQUEST%s&quot;, &quot;, ignoring packet&quot;);
			continue;
		&#125;
		state &#x3D; udhcp_get_option(&amp;packet, DHCP_MESSAGE_TYPE);
		if (state &#x3D;&#x3D; NULL || state[0] &lt; DHCP_MINTYPE || state[0] &gt; DHCP_MAXTYPE) &#123;
			bb_info_msg(&quot;no or bad message type option%s&quot;, &quot;, ignoring packet&quot;);
			continue;
		&#125;

		&#x2F;* Get SERVER_ID if present *&#x2F;
		server_id_opt &#x3D; udhcp_get_option32(&amp;packet, DHCP_SERVER_ID);
		if (server_id_opt) &#123;
			uint32_t server_id_network_order;
			move_from_unaligned32(server_id_network_order, server_id_opt);
			if (server_id_network_order !&#x3D; server_data.server_nip) &#123;
				&#x2F;* client talks to somebody else *&#x2F;
				log1(&quot;server ID doesn&#39;t match%s&quot;, &quot;, ignoring&quot;);
				continue;
			&#125;
		&#125;

		&#x2F;* Look for a static&#x2F;dynamic lease *&#x2F;
		static_lease_nip &#x3D; get_static_nip_by_mac(&amp;packet.chaddr);
		if (static_lease_nip) &#123;
			bb_info_msg(&quot;found static lease: %x&quot;, static_lease_nip);
			memcpy(&amp;fake_lease.lease_mac, &amp;packet.chaddr, 6);
			fake_lease.lease_nip &#x3D; static_lease_nip;
			fake_lease.expires &#x3D; 0;
			lease &#x3D; &amp;fake_lease;
		&#125; else &#123;
&#x2F;********* MACé™åˆ¶ *********&#x2F;
&#x2F;*æ ¡éªŒmacé™åˆ¶
ENABLE_UDHCPD_SET_HOSTMACå®å®šä¹‰åœ¨include&#x2F;autoconf.hå¤´æ–‡ä»¶ä¸­ï¼Œ
è¯¥å¤´æ–‡ä»¶make menuconfigé…ç½®åç”Ÿæˆçš„å¤´æ–‡ä»¶
*&#x2F;
#if ENABLE_UDHCPD_SET_HOSTMAC
			int i &#x3D; 0;
			for(i &#x3D; 0; i &lt; 6; i++)
			&#123;
				if(mask &amp; (0x1 &lt;&lt; i)) 
				&#123;
					if(packet.chaddr[i] !&#x3D; mac[i])
					&#123;
						break;
					&#125;
				&#125;
			&#125;
			
			if(i !&#x3D; 6)
			&#123;
				continue;
			&#125;
#endif
&#x2F;********* MACé™åˆ¶ *********&#x2F;
			lease &#x3D; find_lease_by_mac(packet.chaddr);
			bb_info_msg(&quot;mac:%02x:%02x:%02x:%02x:%02x:%02x \n&quot;, packet.chaddr[0], packet.chaddr[1], packet.chaddr[2], packet.chaddr[3], packet.chaddr[4], packet.chaddr[5]);
		&#125;

		&#x2F;* Get REQUESTED_IP if present *&#x2F;
		requested_nip &#x3D; 0;
		requested_ip_opt &#x3D; udhcp_get_option32(&amp;packet, DHCP_REQUESTED_IP);
		if (requested_ip_opt) &#123;
			move_from_unaligned32(requested_nip, requested_ip_opt);
		&#125;

		switch (state[0]) &#123;

		case DHCPDISCOVER:
			log1(&quot;received %s&quot;, &quot;DISCOVER&quot;);

			send_offer(&amp;packet, static_lease_nip, lease, requested_nip, arpping_ms);
			break;

		case DHCPREQUEST:
			log1(&quot;received %s&quot;, &quot;REQUEST&quot;);
&#x2F;* RFC 2131:

o DHCPREQUEST generated during SELECTING state:

   Client inserts the address of the selected server in &#39;server
   identifier&#39;, &#39;ciaddr&#39; MUST be zero, &#39;requested IP address&#39; MUST be
   filled in with the yiaddr value from the chosen DHCPOFFER.

   Note that the client may choose to collect several DHCPOFFER
   messages and select the &quot;best&quot; offer.  The client indicates its
   selection by identifying the offering server in the DHCPREQUEST
   message.  If the client receives no acceptable offers, the client
   may choose to try another DHCPDISCOVER message.  Therefore, the
   servers may not receive a specific DHCPREQUEST from which they can
   decide whether or not the client has accepted the offer.

o DHCPREQUEST generated during INIT-REBOOT state:

   &#39;server identifier&#39; MUST NOT be filled in, &#39;requested IP address&#39;
   option MUST be filled in with client&#39;s notion of its previously
   assigned address. &#39;ciaddr&#39; MUST be zero. The client is seeking to
   verify a previously allocated, cached configuration. Server SHOULD
   send a DHCPNAK message to the client if the &#39;requested IP address&#39;
   is incorrect, or is on the wrong network.

   Determining whether a client in the INIT-REBOOT state is on the
   correct network is done by examining the contents of &#39;giaddr&#39;, the
   &#39;requested IP address&#39; option, and a database lookup. If the DHCP
   server detects that the client is on the wrong net (i.e., the
   result of applying the local subnet mask or remote subnet mask (if
   &#39;giaddr&#39; is not zero) to &#39;requested IP address&#39; option value
   doesn&#39;t match reality), then the server SHOULD send a DHCPNAK
   message to the client.

   If the network is correct, then the DHCP server should check if
   the client&#39;s notion of its IP address is correct. If not, then the
   server SHOULD send a DHCPNAK message to the client. If the DHCP
   server has no record of this client, then it MUST remain silent,
   and MAY output a warning to the network administrator. This
   behavior is necessary for peaceful coexistence of non-
   communicating DHCP servers on the same wire.

   If &#39;giaddr&#39; is 0x0 in the DHCPREQUEST message, the client is on
   the same subnet as the server.  The server MUST broadcast the
   DHCPNAK message to the 0xffffffff broadcast address because the
   client may not have a correct network address or subnet mask, and
   the client may not be answering ARP requests.

   If &#39;giaddr&#39; is set in the DHCPREQUEST message, the client is on a
   different subnet.  The server MUST set the broadcast bit in the
   DHCPNAK, so that the relay agent will broadcast the DHCPNAK to the
   client, because the client may not have a correct network address
   or subnet mask, and the client may not be answering ARP requests.

o DHCPREQUEST generated during RENEWING state:

   &#39;server identifier&#39; MUST NOT be filled in, &#39;requested IP address&#39;
   option MUST NOT be filled in, &#39;ciaddr&#39; MUST be filled in with
   client&#39;s IP address. In this situation, the client is completely
   configured, and is trying to extend its lease. This message will
   be unicast, so no relay agents will be involved in its
   transmission.  Because &#39;giaddr&#39; is therefore not filled in, the
   DHCP server will trust the value in &#39;ciaddr&#39;, and use it when
   replying to the client.

   A client MAY choose to renew or extend its lease prior to T1.  The
   server may choose not to extend the lease (as a policy decision by
   the network administrator), but should return a DHCPACK message
   regardless.

o DHCPREQUEST generated during REBINDING state:

   &#39;server identifier&#39; MUST NOT be filled in, &#39;requested IP address&#39;
   option MUST NOT be filled in, &#39;ciaddr&#39; MUST be filled in with
   client&#39;s IP address. In this situation, the client is completely
   configured, and is trying to extend its lease. This message MUST
   be broadcast to the 0xffffffff IP broadcast address.  The DHCP
   server SHOULD check &#39;ciaddr&#39; for correctness before replying to
   the DHCPREQUEST.

   The DHCPREQUEST from a REBINDING client is intended to accommodate
   sites that have multiple DHCP servers and a mechanism for
   maintaining consistency among leases managed by multiple servers.
   A DHCP server MAY extend a client&#39;s lease only if it has local
   administrative authority to do so.
*&#x2F;
			if (!requested_ip_opt) &#123;
				requested_nip &#x3D; packet.ciaddr;
				if (requested_nip &#x3D;&#x3D; 0) &#123;
					log1(&quot;no requested IP and no ciaddr%s&quot;, &quot;, ignoring&quot;);
					break;
				&#125;
			&#125;
			if (lease &amp;&amp; requested_nip &#x3D;&#x3D; lease-&gt;lease_nip) &#123;
				&#x2F;* client requested or configured IP matches the lease.
				 * ACK it, and bump lease expiration time. *&#x2F;
				send_ACK(&amp;packet, lease-&gt;lease_nip);
				break;
			&#125;
			&#x2F;* No lease for this MAC, or lease IP !&#x3D; requested IP *&#x2F;

			if (server_id_opt    &#x2F;* client is in SELECTING state *&#x2F;
			 || requested_ip_opt &#x2F;* client is in INIT-REBOOT state *&#x2F;
			) &#123;
				&#x2F;* &quot;No, we don&#39;t have this IP for you&quot; *&#x2F;
				send_NAK(&amp;packet);
			&#125; &#x2F;* else: client is in RENEWING or REBINDING, do not answer *&#x2F;

			break;

		case DHCPDECLINE:
			&#x2F;* RFC 2131:
			 * &quot;If the server receives a DHCPDECLINE message,
			 * the client has discovered through some other means
			 * that the suggested network address is already
			 * in use. The server MUST mark the network address
			 * as not available and SHOULD notify the local
			 * sysadmin of a possible configuration problem.&quot;
			 *
			 * SERVER_ID must be present,
			 * REQUESTED_IP must be present,
			 * chaddr must be filled in,
			 * ciaddr must be 0 (we do not check this)
			 *&#x2F;
			log1(&quot;received %s&quot;, &quot;DECLINE&quot;);
			if (server_id_opt
			 &amp;&amp; requested_ip_opt
			 &amp;&amp; lease  &#x2F;* chaddr matches this lease *&#x2F;
			 &amp;&amp; requested_nip &#x3D;&#x3D; lease-&gt;lease_nip
			) &#123;
				memset(lease-&gt;lease_mac, 0, sizeof(lease-&gt;lease_mac));
				lease-&gt;expires &#x3D; time(NULL) + server_data.decline_time;
			&#125;
			break;

		case DHCPRELEASE:
			&#x2F;* &quot;Upon receipt of a DHCPRELEASE message, the server
			 * marks the network address as not allocated.&quot;
			 *
			 * SERVER_ID must be present,
			 * REQUESTED_IP must not be present (we do not check this),
			 * chaddr must be filled in,
			 * ciaddr must be filled in
			 *&#x2F;
			log1(&quot;received %s&quot;, &quot;RELEASE&quot;);
			if (server_id_opt
			 &amp;&amp; lease  &#x2F;* chaddr matches this lease *&#x2F;
			 &amp;&amp; packet.ciaddr &#x3D;&#x3D; lease-&gt;lease_nip
			) &#123;
				lease-&gt;expires &#x3D; time(NULL);
			&#125;
			break;

		case DHCPINFORM:
			log1(&quot;received %s&quot;, &quot;INFORM&quot;);
			send_inform(&amp;packet);
			break;
		&#125;
	&#125;
 ret0:
	retval &#x3D; 0;
 ret:
	&#x2F;*if (server_data.pidfile) - server_data.pidfile is never NULL *&#x2F;
		remove_pidfile(server_data.pidfile);
	return retval;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>

      </div>
      
        <div class="copyright">
  <ul class="post-copyright">
    <li class="post-copyright-author">
    <strong>ä½œè€…:  </strong>marysufer</a>
    </li>
    <li class="post-copyright-link">
    <strong>æ–‡ç« é“¾æ¥:  </strong>
    <a href="/2023/09/26/busybox-tian-jia-menuconfig-pei-zhi-xuan-xiang/" target="_blank" title="busyboxç¼–è¯‘ä»¥åŠæ·»åŠ menuconfigé…ç½®é€‰é¡¹">https://fighthawklyl.github.io/2023/09/26/busybox-tian-jia-menuconfig-pei-zhi-xuan-xiang/</a>
    </li>
    <li class="post-copyright-license">
      <strong>ç‰ˆæƒå£°æ˜:   </strong>
      æœ¬ç½‘ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–,å‡é‡‡ç”¨ <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a>
      è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„!
    </li>
  </ul>
<div>
      
    </article>
    <!-- ä¸Šä¸€ç¯‡æ–‡ç« å’Œä¸‹ä¸€ç¯‡æ–‡ç«  -->
    
      <!-- æ–‡ç« è¯¦æƒ…é¡µçš„ä¸Šä¸€é¡µå’Œä¸‹ä¸€é¡µ -->
<div class="post-nav">





  
  <div class="post-nav-next post-nav-item">
    <div class="post-nav-img lazyload" data-original="/medias/13.jpg" style="background-size: cover; 
      background-position: center center;">
    </div>
    <a href="/2023/08/02/udhcpc6-qian-ru-shi-huo-qu-ipv6/" class="post-nav-link">
      <div class="title">
        ä¸‹ä¸€ç¯‡: <i class="fa fa-angle-right"></i>
        <div>udhcpc6åµŒå…¥å¼è·å–IPV6</div>
      </div>
      <!-- <div class="content">
        è·å–å‘½ä»¤udhcpc6 -b -i -eth0
# -s å¯ä»¥æŒ‡å®šdhcpcçš„è„šæœ¬æ–‡ä»¶è·¯å¾„

default.scrip
      </div> -->
    </a>
  </div>

</div>

    
    

    <!-- æ‰“èµ -->
    
      <div id="appDonate" class="post-donate">
  <div id="donate_board" class="donate_bar center" ref="donate">
    <a id="btn_donate" class="btn_donate" href="javascript:;" title="æ‰“èµ" @click="showDialogDrawer()"></a>
  </div>
  <transition name="fade">
    <div 
      class="donate-box-mask"
      v-cloak 
      v-if="visible"
      @click="cancelDialogDrawer()"
    >
    </div>
  </transition>
  <transition name="bounce">
    <div class="donate-box" v-cloak v-if="visible">
      <div class="donate-box_close">
        <i class="fa fa-times" aria-hidden="true" @click="cancelDialogDrawer"></i>
      </div>
      <div class="donate-box_title">
        <h4>
          ä½ çš„èµè¯†æ˜¯æˆ‘å‰è¿›çš„åŠ¨åŠ›
        </h4>
      </div>
      <div class="donate-box_tab">
        <div class="Alipay" :class="{'active': tabActive === 'Alipay'}" @click="changeTabActive('Alipay')">
          æ”¯ä»˜å®
        </div>
        <div class="WeChatpay" :class="{'active': tabActive === 'WeChatpay'}" @click="changeTabActive('WeChatpay')">
          å¾®ä¿¡
        </div>
      </div>
      <div class="donate-box_img">
        <div class="AlipayImg" v-if="tabActive === 'Alipay'">
          <img src="/medias/zfb.jpg" alt="æ”¯ä»˜å®æ‰“èµ" />
        </div> 
        <div class="WeChatpayImg" v-if="tabActive === 'WeChatpay'">
          <img src="/medias/wx.jpg" alt="å¾®ä¿¡æ‰“èµ" />
        </div>
      </div>
    </div>
  </transition>
</div>

<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appDonate',
    data: {
      visible: false,
      tabActive: 'Alipay',
      top: 0,
    },
    computed: {
    },
    mounted() {
    },
    methods: {
      showDialogDrawer() {
        this.visible = true;
        // é˜²æ­¢é¡µé¢æ»šåŠ¨ï¼Œåªèƒ½è®©å¼¹æ¡†æ»šåŠ¨
        // function getScroll() {
        //   return {
        //     left: window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft || 0,
        //     top: window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0
        //   };
        // }
        this.top = $(document).scrollTop() // or getScroll().top
        // console.log('aa', $('.main-content'));
        body.style.cssText = 'overflow: hidden;';
      },
      cancelDialogDrawer() {
        this.visible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      },
      changeTabActive(name) {
        this.tabActive = name;
      }
    },
    created() {}
  })
</script>
    

    <!-- åˆ†äº« -->
    
      <!-- https://github.com/overtrue/share.js -->
<!-- æ–‡ç« è¯¦æƒ…é¡µçš„åˆ†äº« -->
<div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯åˆ†äº«ï¼</p>"></div>

<script src="/js/shareJs/social-share.min.js"></script>
</script>

<style>
  .social-share {
    margin: 20px 0;
  }
</style>


    
    
    <!-- è¯„è®º -->
    <!-- è¯„è®º -->

  <div id="myComment">
    
      <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/gitalk/1.7.2/gitalk.css">
<div id="gitalk-container"></div>
<script src="https://cdn.bootcdn.net/ajax/libs/gitalk/1.7.2/gitalk.js"></script>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: '0ff20f0fc37200b83d03',
        clientSecret: 'ef8b2c4bbc3f8232d171e49963abf3b6869d43cb',
        id: window.location.pathname,
        repo: 'blog_comments',
        owner: 'fighthawklyl',
        admin: ['fighthawklyl']
    })
    gitalk.render('gitalk-container')
</script>

<style>
    .gt-container .gt-meta {
        z-index: 2;
    }
</style>
    
  </div>


  </div>

  <!-- ç›®å½• -->
  <!-- æ–‡ç« è¯¦æƒ…é¡µå³ä¾§ç›®å½• -->

  <div class="toc-aside">
    <div class="toc-main">
      <div class="toc-aside-title">
        <i class="fa fa-list-ul" aria-hidden="true"></i><span>æœ¬æ–‡ç›®å½•</span>
        <div class="toc-open-close">æœ¬æ–‡ç›®å½•</div>
      </div>
      <div class="toc-content">
        <link href="/js/tocbot/tocbot.css" rel="stylesheet">
<script src="/js/tocbot/tocbot.min.js"></script>
<div class="toc"></div>

<script>
  if ($('.toc').length > 0) {
    var headerEl = 'h2, h3, h4',  //headers 
      content = '.post-detail',//æ–‡ç« å®¹å™¨
      idArr = {};  //æ ‡é¢˜æ•°ç»„ä»¥ç¡®å®šæ˜¯å¦å¢åŠ ç´¢å¼•id
      //add #id

    $(content).children(headerEl).each(function () {
      //å»é™¤ç©ºæ ¼ä»¥åŠå¤šä½™æ ‡ç‚¹
      var headerId = $(this).text().replace(/[\s|\~|`|\!|\@|\#|\$|\%|\^|\&|\*|\(|\)|\_|\+|\=|\||\|\[|\]|\{|\}|\;|\:|\"|\'|\,|\<|\.|\>|\/|\?|\ï¼š|\ï¼Œ|\ã€‚]/g, '');

      headerId = headerId.toLowerCase();
      if (idArr[headerId]) {
        //idå·²ç»å­˜åœ¨
        $(this).attr('id', headerId + '-' + idArr[headerId]);
        idArr[headerId]++;
      }
      else {
        //idæœªå­˜åœ¨
        idArr[headerId] = 1;
        $(this).attr('id', headerId);
      }
    });

    tocbot.init({
      // Where to render the table of contents.
      tocSelector: '.toc',
      // Where to grab the headings to build the table of contents.
      contentSelector: content,
      // Which headings to grab inside of the contentSelector element.
      headingSelector: headerEl,
      scrollSmooth: true,
      scrollSmoothOffset: -80,
      headingsOffset: -($(window).height() * 0.4 - 45),
      positionFixedSelector: '.toc-main',
      positionFixedClass: 'is-position-fixed',
      fixedSidebarOffset: 'auto',
    });
  }

</script>

<style>
.is-position-fixed {
  position:sticky !important;
  top: 74px;
}
.toc-main ul {
  counter-reset: show-list;
}
.toc-main ul li::before {
  content: counter(item)".";
  display: block;
  position: absolute;
  left: 12px;
  top:0;
}
.toc > .toc-list {
  padding-left: 35px;
}
.toc>.toc-list li {
  list-style: decimal;
}
.toc-list {
  padding-left: 25px;
}
</style>
      </div>
    </div>
  </div>

  

  <script>
    let openOrCloseBtn = $('.toc-aside .toc-aside-title .toc-open-close');
    let open = eval('' || 'true');
    openOrCloseBtn.click(function() {
      if (open === true) {
        $(".toc-aside").css({'width': 0, 'padding': 0});
        $(".toc-content").css({'width': 0});
        $(".toc-aside-title span, .toc-aside-title i").css({'display': 'none'});
        $(".main-content").css({'width': '75%', 'margin': '10px auto'});
        open = false;
      } else {
        $(".toc-aside").css({'width': '300px', 'padding': '0 10px'});
        $(".toc-content").css({'width': '300px'});
        $(".toc-aside-title span, .toc-aside-title i").css({'display': 'inline-block'});
        $(".main-content").css({'width': '65%', 'margin-right': '10px', 'margin-left': 'calc(35% - 350px)'});
        open = true;
      }
    });
  </script>


  <!-- æ¸²æŸ“issuesæ ‡ç­¾é‡Œçš„å†…å®¹ -->
  <script>
  function loadIssuesJS() {
    if ($(".post-detail").find(".issues-api").length == 0) return;
    document.write('<script type="text/javascript" src="/js/issues/index.js"><\/script>');
  };
  loadIssuesJS();
</script>

  <!-- å›¾ç‰‡æ”¾å¤§ Wrap images with fancybox support -->
  <script src="/js/wrapImage.js"></script>
</div>

<!-- æ–‡ç« è¯¦æƒ…é¡µèƒŒæ™¯å›¾ -->
<div id="appBgSwiper" style="position: fixed;left: 0;top: 0;width: 100%;height: 100%;z-index: -2;" :style="{'background-color': bgColor ? bgColor : 'transparent'}">
    <transition-group tag="ul" :name="names">
        <li v-for='(image,index) in img' :key='index' v-show="index === mark" class="bg-swiper-box">
            <img :src="image" class="bg-swiper-img">
        </li>
    </transition-group>
</div>
<script>
    var vm = new Vue({
        el: '#appBgSwiper',
        data: {
            names: '' || 'scale' || 'fade', // translate-fade fade
            mark: 0,
            img: [],
            bgColor: '',
            time: null
        },
        methods: {   //æ·»åŠ æ–¹æ³•
            change(i, m) {
                if (i > m) {
                    // this.names = 'fade';
                } else if (i < m) {
                    // this.names = 'fade';
                } else {
                    return;
                }
                this.mark = i;
            },
            prev() {
                // this.names = 'fade';
                this.mark--;
                if (this.mark === -1) {
                    this.mark = 3;
                    return
                }
            },
            next() {
                // this.names = 'fade';
                this.mark++;
                if (this.mark === this.img.length) {
                    this.mark = 0;
                    return
                }
            },
            autoPlay() {
                // this.names = 'fade';
                this.mark++;
                if (this.mark === this.img.length) {
                    this.mark = 0;
                    return
                }
            },
            play() {
                let bgImgDelay = '' || '10000'
                let delay = parseInt(bgImgDelay) || 180000;
                this.time = setInterval(this.autoPlay, delay);
            },
            enter() {
                clearInterval(this.time);
            },
            leave() {
                this.play();
            }
        },
        created() {
            this.play()
        },
        beforeDestroy() {
            clearInterval(this.time);
        },
        mounted() {
            let prop = ''|| '/medias/1.jpg,/medias/2.jpg,/medias/3.jpg,/medias/4.jpg,/medias/5.jpg,/medias/6.jpg,/medias/7.jpg,/medias/8.jpg,/medias/9.jpg,/medias/10.jpg,/medias/11.jpg,/medias/12.jpg,/medias/13.jpg,/medias/14.jpg,/medias/15.jpg,/medias/16.jpg';
            let isImg = prop.includes('.bmp') || prop.includes('.jpg') || prop.includes('.png') || prop.includes('.tif') || prop.includes('.gif') || prop.includes('.pcx') || prop.includes('.tga') || prop.includes('.exif') || prop.includes('.fpx') || prop.includes('.psd') || prop.includes('.cdr') || prop.includes('.pcd') || prop.includes('.dxf') || prop.includes('.ufo') || prop.includes('.eps') || prop.includes('.ai') || prop.includes('.raw') || prop.includes('.WMF') || prop.includes('.webp') || prop.includes('.jpeg') || prop.includes('http://') || prop.includes('https://') 
            if (isImg) {
                let img = prop.split(',');
                let configRoot = '/'
                let arrImg = [];
                img.forEach(el => {
                    var Expression=/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/;
			        var objExp = new RegExp(Expression);

                    if(objExp.test(el)) {
                        // http or https
                        arrImg.push(el);
                    } else {
                        // éhttp or httpså¼€å¤´
                        // æœ¬åœ°æ–‡ä»¶
                        let firstStr = el.charAt(0);
                        if (firstStr == '/') {
                            el = el.substr(1); // åˆ é™¤ç¬¬ä¸€ä¸ªå­—ç¬¦ '/',å› ä¸º configRootæœ€åä¸€ä¸ªå­—ç¬¦ä¸º /
                        }
                        el = configRoot + el;
                        arrImg.push(el);
                    }
                })
                this.img = arrImg;
            } else {
                this.bgColor = prop;
            }
        }
    })
</script>

<style>
    .bg-swiper-box {
        position: absolute;
        display: block;
        width: 100%;
        height: 100%;
    }
    .bg-swiper-img {
        object-fit: cover;
        width: 100%;
        height: 100%;
    }
</style>

    </main>

    <!-- é¡µè„š -->
    <div class="footer bg-color">
  <div class="footer-main">
    <div class="link">
      
    </div>
    <div class="footer-copyright">
      <p>Copyright Â© 2019 - 2020 <a target="_blank" rel="noopener" href="https://github.com/fighthawklyl">MarySufer</a> | Powered by <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/">Hexo</a> | Theme <a target="_blank" rel="noopener" href="https://github.com/yuang01/theme">Bamboo</a> </p>

    </div>
    <div class="footer-custom">
      
    </div>
    <!-- ä¸è’œå­ç»Ÿè®¡ -->
    
      
  <!-- ä¸è’œå­ç»Ÿè®¡ -->
  <span id="busuanzi_container_site_pv">
        <i class="fa fa-book" aria-hidden="true"></i>æœ¬ç«™æ€»é˜…è¯»é‡ï¼š<span id="busuanzi_value_page_pv"></span> æ¬¡
  </span>
  <span id="busuanzi_container_site_pv">
        <i class="fa fa-eye" aria-hidden="true"></i>æœ¬ç«™æ€»è®¿é—®é‡ï¼š<span id="busuanzi_value_site_pv"></span> æ¬¡
  </span>
  <span class="post-meta-divider">|</span>
  <span id="busuanzi_container_site_uv" style='display:none'>
        <i class="fa fa-users" aria-hidden="true"></i>æœ¬ç«™è®¿å®¢æ•°ï¼š<span id="busuanzi_value_site_uv"></span> äºº
  </span>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    
  </div>
</div>


    <!-- æ¸²æŸ“æš—é»‘æŒ‰é’® -->
    
      <div class="dark">
  <div class="dark-content">
    <i class="fa fa-moon-o" aria-hidden="true"></i>
    <!-- <span>å…³ç¯</span> -->
  </div>
  
</div>

<script>
  $(function() {
    let isDark = JSON.parse(localStorage.getItem('dark'))  || JSON.parse('false');
    if (isDark) {
      $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fa fa-lightbulb-o" aria-hidden="true"></i>
          </div>
          `
        );
    }
    $('.dark').click(function() {
      if ($(document.body).is('.darkModel')) {
        $(document.body).removeClass('darkModel');
        localStorage.setItem('dark', false);
        $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fa fa-moon-o" aria-hidden="true"></i>
          </div>
          `
        );
      } else {
        $(document.body).addClass('darkModel');
        localStorage.setItem('dark', true);
        $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fa fa-lightbulb-o" aria-hidden="true"></i>
          </div>
          `
        );
      }
    })
  })
</script>
    
    <!-- æ¸²æŸ“å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
    
      <div class="goTop top-btn-color border-color">
  <i class="fa fa-arrow-up" aria-hidden="true"></i>
</div>
<script src="/js/goTop.js"></script>
    
    <!-- æ¸²æŸ“å·¦ä¸‹è§’éŸ³ä¹æ’­æ”¾å™¨ -->
    
      <link rel="stylesheet" href="/js/aplayer/APlayer@1.10.1.min.css">
<style>
.aplayer .aplayer-lrc p {
  
  font-size: 12px;
  font-weight: 700;
  line-height: 16px !important;
}

.aplayer .aplayer-lrc p.aplayer-lrc-current {
  
  font-size: 15px;
  color: #FFB5C5;
}


.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
  left: -66px !important;
}

.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
  left: 0px !important;
}


</style>
<meting-js  
  class=""
  server="tencent"
  type="playlist"
  id="8067677899"
  fixed='true'
  autoplay='true'
  theme='#FFB5C5'
  loop='all'
  order='random'
  preload='auto'
  volume='0.7'
  list-folded='true'
>
</meting-js>

<!-- <style>
  #aplayer {
    position: fixed;
    left: 0;
    bottom: 300px;
  }
</style> -->
<script src="https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
    

    <!-- å›¾ç‰‡æ”¾å¤§ -->
    
      <script src="/js/fancybox/jquery.fancybox.min.js"></script>
    
    
    <!-- é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ -->
    <!-- çˆ±å¿ƒç‚¹å‡» -->

	
		<canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 999; pointer-events: none;" ></canvas>
		<script src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script>
		<script src="/js/cursor/explosion.min.js"></script>
	



    <!-- ç™¾åº¦è§£æ -->
    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <!-- èƒŒæ™¯å½©å¸¦ -->
    <script type="text/javascript" size="100" alpha='0.4' zIndex="-1" src="/js/ribbon.min.js"></script>
    
    <!-- divæ»šåŠ¨åˆ°æ˜¾ç¤ºåŒºåŸŸçš„åŠ¨ç”» -->
    
  <script src="/js/aos/aos.js"></script>
  <script>
    // https://github.com/michalsnik/aos
    const themeOffset = parseInt('120') || 120;
    const themeDelay = parseInt('0') || 0;
    const themeDuration = parseInt('400') || 400;
    const themeEasing = 'ease' || 'ease';
    const themeOnce = eval('true') || false;
    const themeMirror = eval('false') || false;
    const themeAnchorPlacement = 'top-bottom' || 'top-bottom';
    AOS.init({
      // Global settings:
      disable: false, // accepts following values: 'phone', 'tablet', 'mobile', boolean, expression or function
      startEvent: 'DOMContentLoaded', // name of the event dispatched on the document, that AOS should initialize on
      initClassName: 'aos-init', // class applied after initialization
      animatedClassName: 'aos-animate', // class applied on animation
      useClassNames: false, // if true, will add content of `data-aos` as classes on scroll
      disableMutationObserver: false, // disables automatic mutations' detections (advanced)
      debounceDelay: 50, // the delay on debounce used while resizing window (advanced)
      throttleDelay: 99, // the delay on throttle used while scrolling the page (advanced)

      // Settings that can be overridden on per-element basis, by `data-aos-*` attributes:
      offset: themeOffset, // offset (in px) from the original trigger point
      delay: themeDelay, // values from 0 to 3000, with step 50ms
      duration: themeDuration, // values from 0 to 3000, with step 50ms
      easing: themeEasing, // default easing for AOS animations
      once: themeOnce, // whether animation should happen only once - while scrolling down
      mirror: themeMirror, // whether elements should animate out while scrolling past them
      anchorPlacement: themeAnchorPlacement, // defines which position of the element regarding to window should trigger the animation

    });
  </script>

    
    <!-- å¤åˆ¶æç¤º -->
    
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/v-plugs-ayu/lib/ayu.css">
  <script src="https://cdn.jsdelivr.net/npm/v-plugs-ayu/lib/ayu.umd.min.js"></script>
  <div id="appCopy">
  </div>
  <script>
    var vm = new Vue({
      el: '#appCopy',
      data: {
      },
      computed: {
      },
      mounted() {
        const that = this;
        //  ç›‘å¬ ctrl + cäº‹ä»¶  
        $(document).unbind('keypress').bind('keypress', function (e) {
          if (e.ctrlKey && e.keyCode == 67) {
            doSomething();
            // è¿”å›false, é˜²æ­¢é‡å¤è§¦å‘copyäº‹ä»¶  
            return false;
          }
        })

        // é¼ æ ‡å³é”®çš„å¤åˆ¶äº‹ä»¶  
        $(document).unbind('copy').bind('copy', function (e) {
          doSomething();
          // console.log('å³é”®å¤åˆ¶ ç›‘å¬æˆåŠŸ');
        });

        function doSomething() {
          that.$notify({
            title: "å“‡å“¦!",
            content: "ä½ æ‚„æ‚„çš„æŒ–èµ°äº†ä¸€äº›å¥‡æ€ªçš„ä¸œè¥¿ï¼",
            type: 'success'
          })
          // console.log('ctrl + c ç›‘å¬æˆåŠŸ');  
        }
      },
      methods: {
      },
      created() { }
    })
  </script>


    <!-- è¾“å…¥æ¡†æ‰“å­—ç‰¹æ•ˆ -->
    <!-- è¾“å…¥æ¡†æ‰“å­—ç‰¹æ•ˆ -->

  <script src="/js/activate-power-mode.js"></script>
  <script>
    POWERMODE.colorful = true;  // æ‰“å¼€éšæœºé¢œè‰²ç‰¹æ•ˆ
    POWERMODE.shake = false;    // å…³é—­è¾“å…¥æ¡†æŠ–åŠ¨
    document.body.addEventListener('input', POWERMODE);//ç›‘å¬æ‰“å­—äº‹ä»¶
  </script>


    <!-- markdownä»£ç ä¸€é”®å¤åˆ¶åŠŸèƒ½ -->
    <!-- markdownä»£ç ä¸€é”®å¤åˆ¶åŠŸèƒ½ -->
<script src="/js/clipboard/clipboard.min.js"></script>
<script>
  !function (e, t, a) {
    var copy = 'å¤åˆ¶';
    /* code */
    var initCopyCode = function () {
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="" style="position:absolute;top:0;right:0;z-index:1;">';
      copyHtml += '<i class="fa fa-copy"></i><span>' + copy + '</span>';
      copyHtml += '</button>';
      $(".post-detail pre").not('.gutter pre').wrap("<div class='codeBox' style='position:relative;width:100%;'></div>")
      $(".post-detail pre").not('.gutter pre').before(copyHtml);
      new ClipboardJS('.btn-copy', {
        target: function (trigger) {
          return trigger.nextElementSibling;
        }
      });
    }
    initCopyCode();
  }(window, document);
</script>
    
    <!-- å›¾ç‰‡æ‡’åŠ è½½ -->
    <script src="/js/lazyload/lazyload@1.9.1.js"></script>
<script>
  $(function () {
    $("div.lazyload, img.lazyload, a.lazyload").lazyload(
      {
        effect: "fadeIn",
        placeholder: "https://img10.360buyimg.com/ddimg/jfs/t1/159345/8/2271/222193/5ff7b36fEe49f5663/a95287c20385127f.gif"    //å›¾ç‰‡æœªåŠ è½½å‡ºæ¥æ—¶æ˜¾ç¤ºçš„å ä½å›¾
      }
    );
  });
</script>
    
    <script src="/js/app.js"></script>

  </body>
</html>